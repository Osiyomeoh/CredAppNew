(function(X,ke){typeof exports=="object"&&typeof module<"u"?ke(exports):typeof define=="function"&&define.amd?define(["exports"],ke):(X=typeof globalThis<"u"?globalThis:X||self,ke(X["@walletconnect/core"]={}))})(this,function(X){"use strict";var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function At(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var ut={exports:{}},zt=typeof Reflect=="object"?Reflect:null,ui=zt&&typeof zt.apply=="function"?zt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Or;zt&&typeof zt.ownKeys=="function"?Or=zt.ownKeys:Object.getOwnPropertySymbols?Or=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Or=function(t){return Object.getOwnPropertyNames(t)};function Ia(e){console&&console.warn&&console.warn(e)}var fi=Number.isNaN||function(t){return t!==t};function Se(){Se.init.call(this)}ut.exports=Se,ut.exports.once=Pa,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var hi=10;function xr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return hi},set:function(e){if(typeof e!="number"||e<0||fi(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");hi=e}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||fi(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function li(e){return e._maxListeners===void 0?Se.defaultMaxListeners:e._maxListeners}Se.prototype.getMaxListeners=function(){return li(this)},Se.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var c;if(r.length>0&&(c=r[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")ui(h,this,r);else for(var f=h.length,d=pi(h,f),n=0;n<f;++n)ui(d[n],this,r);return!0};function di(e,t,r,n){var i,s,c;if(xr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),c=s[t]),c===void 0)c=s[t]=r,++e._eventsCount;else if(typeof c=="function"?c=s[t]=n?[r,c]:[c,r]:n?c.unshift(r):c.push(r),i=li(e),i>0&&c.length>i&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=c.length,Ia(u)}return e}Se.prototype.addListener=function(t,r){return di(this,t,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(t,r){return di(this,t,r,!0)};function Ra(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _i(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=Ra.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(t,r){return xr(r),this.on(t,_i(this,t,r)),this},Se.prototype.prependOnceListener=function(t,r){return xr(r),this.prependListener(t,_i(this,t,r)),this},Se.prototype.removeListener=function(t,r){var n,i,s,c,u;if(xr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,c=n.length-1;c>=0;c--)if(n[c]===r||n[c].listener===r){u=n[c].listener,s=c;break}if(s<0)return this;s===0?n.shift():Aa(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,u||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),c;for(i=0;i<s.length;++i)c=s[i],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function gi(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Ca(i):pi(i,i.length)}Se.prototype.listeners=function(t){return gi(this,t,!0)},Se.prototype.rawListeners=function(t){return gi(this,t,!1)},Se.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):yi.call(e,t)},Se.prototype.listenerCount=yi;function yi(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?Or(this._events):[]};function pi(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Aa(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Ca(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Pa(e,t){return new Promise(function(r,n){function i(c){e.removeListener(t,s),n(c)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}bi(e,t,s,{once:!0}),t!=="error"&&La(e,i,{once:!0})})}function La(e,t,r){typeof e.on=="function"&&bi(e,"error",t,r)}function bi(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}function Na(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Ua=Ma;function Ma(e,t,r){var n=r&&r.stringify||Na,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var c=new Array(s);c[0]=n(e);for(var u=1;u<s;u++)c[u]=n(t[u]);return c.join(" ")}if(typeof e!="string")return e;var h=t.length;if(h===0)return e;for(var f="",d=1-i,w=-1,v=e&&e.length||0,b=0;b<v;){if(e.charCodeAt(b)===37&&b+1<v){switch(w=w>-1?w:0,e.charCodeAt(b+1)){case 100:case 102:if(d>=h||t[d]==null)break;w<b&&(f+=e.slice(w,b)),f+=Number(t[d]),w=b+2,b++;break;case 105:if(d>=h||t[d]==null)break;w<b&&(f+=e.slice(w,b)),f+=Math.floor(Number(t[d])),w=b+2,b++;break;case 79:case 111:case 106:if(d>=h||t[d]===void 0)break;w<b&&(f+=e.slice(w,b));var T=typeof t[d];if(T==="string"){f+="'"+t[d]+"'",w=b+2,b++;break}if(T==="function"){f+=t[d].name||"<anonymous>",w=b+2,b++;break}f+=n(t[d]),w=b+2,b++;break;case 115:if(d>=h)break;w<b&&(f+=e.slice(w,b)),f+=String(t[d]),w=b+2,b++;break;case 37:w<b&&(f+=e.slice(w,b)),f+="%",w=b+2,b++,d--;break}++d}++b}return w===-1?e:(w<v&&(f+=e.slice(w)),f)}const vi=Ua;var en=pt;const Jt=qa().console||{},ja={mapHttpRequest:Ir,mapHttpResponse:Ir,wrapRequestSerializer:rn,wrapResponseSerializer:rn,wrapErrorSerializer:rn,req:Ir,res:Ir,err:Ha};function $a(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function pt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||Jt;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=$a(e.browser.serialize,n);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const c=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const u=e.level||"info",h=Object.create(r);h.log||(h.log=Zt),Object.defineProperty(h,"levelVal",{get:d}),Object.defineProperty(h,"level",{get:w,set:v});const f={transmit:t,serialize:i,asObject:e.browser.asObject,levels:c,timestamp:Ka(e)};h.levels=pt.levels,h.level=u,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=Zt,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=b,t&&(h._logEvent=tn());function d(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function v(T){if(T!=="silent"&&!this.levels.values[T])throw Error("unknown level "+T);this._level=T,Ht(f,h,"error","log"),Ht(f,h,"fatal","error"),Ht(f,h,"warn","error"),Ht(f,h,"info","log"),Ht(f,h,"debug","log"),Ht(f,h,"trace","log")}function b(T,U){if(!T)throw new Error("missing bindings for child Pino");U=U||{},i&&T.serializers&&(U.serializers=T.serializers);const L=U.serializers;if(i&&L){var K=Object.assign({},n,L),S=e.browser.serialize===!0?Object.keys(K):i;delete T.serializers,Tr([T],S,K,this._stdErrSerialize)}function I(y){this._childLevel=(y._childLevel|0)+1,this.error=Kt(y,T,"error"),this.fatal=Kt(y,T,"fatal"),this.warn=Kt(y,T,"warn"),this.info=Kt(y,T,"info"),this.debug=Kt(y,T,"debug"),this.trace=Kt(y,T,"trace"),K&&(this.serializers=K,this._serialize=S),t&&(this._logEvent=tn([].concat(y._logEvent.bindings,T)))}return I.prototype=this,new I(this)}return h}pt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},pt.stdSerializers=ja,pt.stdTimeFunctions=Object.assign({},{nullTime:Ei,epochTime:wi,unixTime:Ga,isoTime:Va});function Ht(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?Zt:i[r]?i[r]:Jt[r]||Jt[n]||Zt,Fa(e,t,r)}function Fa(e,t,r){!e.transmit&&t[r]===Zt||(t[r]=function(n){return function(){const s=e.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Jt?Jt:this;for(var h=0;h<c.length;h++)c[h]=arguments[h];if(e.serialize&&!e.asObject&&Tr(c,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(u,Ba(this,r,c,s)):n.apply(u,c),e.transmit){const f=e.transmit.level||t.level,d=pt.levels.values[f],w=pt.levels.values[r];if(w<d)return;za(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:f,transmitValue:pt.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},c)}}}(t[r]))}function Ba(e,t,r,n){e._serialize&&Tr(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let s=i[0];const c={};n&&(c.time=n),c.level=pt.levels.values[t];let u=(e._childLevel|0)+1;if(u<1&&(u=1),s!==null&&typeof s=="object"){for(;u--&&typeof i[0]=="object";)Object.assign(c,i.shift());s=i.length?vi(i.shift(),i):void 0}else typeof s=="string"&&(s=vi(i.shift(),i));return s!==void 0&&(c.msg=s),c}function Tr(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=pt.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(const s in e[i])t&&t.indexOf(s)>-1&&s in r&&(e[i][s]=r[s](e[i][s]))}function Kt(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function za(e,t,r){const n=t.send,i=t.ts,s=t.methodLevel,c=t.methodValue,u=t.val,h=e._logEvent.bindings;Tr(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),e._logEvent.level.label=s,e._logEvent.level.value=c,n(s,e._logEvent,u),e._logEvent=tn(h)}function tn(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Ha(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function Ka(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Ei:wi}function Ir(){return{}}function rn(e){return e}function Zt(){}function Ei(){return!1}function wi(){return Date.now()}function Ga(){return Math.round(Date.now()/1e3)}function Va(){return new Date(Date.now()).toISOString()}function qa(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}var Rr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var nn=function(e,t){return nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},nn(e,t)};function Ya(e,t){nn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var sn=function(){return sn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},sn.apply(this,arguments)};function Wa(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Xa(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(s=(i<3?c(s):i>3?c(t,r,s):c(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function ka(e,t){return function(r,n){t(r,n,e)}}function Ja(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Za(e,t,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(d){try{f(n.next(d))}catch(w){c(w)}}function h(d){try{f(n.throw(d))}catch(w){c(w)}}function f(d){d.done?s(d.value):i(d.value).then(u,h)}f((n=n.apply(e,t||[])).next())})}function Qa(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(d){return h([f,d])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function ec(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function tc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function on(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function mi(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],c;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function rc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mi(arguments[t]));return e}function nc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function Qt(e){return this instanceof Qt?(this.v=e,this):new Qt(e)}function ic(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof Qt?Promise.resolve(v.value.v).then(f,d):w(s[0][2],v)}function f(v){u("next",v)}function d(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function sc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(c){return(r=!r)?{value:Qt(e[i](c)),done:i==="return"}:s?s(c):c}:s}}function oc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof on=="function"?on(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(c){return new Promise(function(u,h){c=e[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function ac(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function cc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function uc(e){return e&&e.__esModule?e:{default:e}}function fc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function hc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var lc=Object.freeze({__proto__:null,__extends:Ya,get __assign(){return sn},__rest:Wa,__decorate:Xa,__param:ka,__metadata:Ja,__awaiter:Za,__generator:Qa,__createBinding:ec,__exportStar:tc,__values:on,__read:mi,__spread:rc,__spreadArrays:nc,__await:Qt,__asyncGenerator:ic,__asyncDelegator:sc,__asyncValues:oc,__makeTemplateObject:ac,__importStar:cc,__importDefault:uc,__classPrivateFieldGet:fc,__classPrivateFieldSet:hc}),Di=At(lc),er={};Object.defineProperty(er,"__esModule",{value:!0});function dc(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}er.safeJsonParse=dc;function _c(e){return typeof e=="string"?e:JSON.stringify(e,(t,r)=>typeof r>"u"?null:r)}er.safeJsonStringify=_c;var tr={exports:{}},Si;function gc(){return Si||(Si=1,function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,n){this[r]=String(n)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ke<"u"&&ke.localStorage?tr.exports=ke.localStorage:typeof window<"u"&&window.localStorage?tr.exports=window.localStorage:tr.exports=new t}()),tr.exports}var an={},rr={},Oi;function yc(){if(Oi)return rr;Oi=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.IKeyValueStorage=void 0;class e{}return rr.IKeyValueStorage=e,rr}var nr={},xi;function pc(){if(xi)return nr;xi=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.parseEntry=void 0;const e=er;function t(r){var n;return[r[0],e.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return nr.parseEntry=t,nr}var Ti;function bc(){return Ti||(Ti=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Di;t.__exportStar(yc(),e),t.__exportStar(pc(),e)}(an)),an}Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.KeyValueStorage=void 0;const Gt=Di,Ii=er,vc=Gt.__importDefault(gc()),Ec=bc();class Ri{constructor(){this.localStorage=vc.default}getKeys(){return Gt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Gt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Ec.parseEntry)})}getItem(t){return Gt.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Ii.safeJsonParse(r)})}setItem(t,r){return Gt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Ii.safeJsonStringify(r))})}removeItem(t){return Gt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Rr.KeyValueStorage=Ri;var wc=Rr.default=Ri,ir={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var cn=function(e,t){return cn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},cn(e,t)};function mc(e,t){cn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var un=function(){return un=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},un.apply(this,arguments)};function Dc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Sc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(s=(i<3?c(s):i>3?c(t,r,s):c(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Oc(e,t){return function(r,n){t(r,n,e)}}function xc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Tc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(d){try{f(n.next(d))}catch(w){c(w)}}function h(d){try{f(n.throw(d))}catch(w){c(w)}}function f(d){d.done?s(d.value):i(d.value).then(u,h)}f((n=n.apply(e,t||[])).next())})}function Ic(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(d){return h([f,d])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Rc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Ac(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function fn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ai(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],c;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Cc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ai(arguments[t]));return e}function Pc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function sr(e){return this instanceof sr?(this.v=e,this):new sr(e)}function Lc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof sr?Promise.resolve(v.value.v).then(f,d):w(s[0][2],v)}function f(v){u("next",v)}function d(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Nc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(c){return(r=!r)?{value:sr(e[i](c)),done:i==="return"}:s?s(c):c}:s}}function Uc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof fn=="function"?fn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(c){return new Promise(function(u,h){c=e[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Mc(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function jc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function $c(e){return e&&e.__esModule?e:{default:e}}function Fc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Bc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var zc=Object.freeze({__proto__:null,__extends:mc,get __assign(){return un},__rest:Dc,__decorate:Sc,__param:Oc,__metadata:xc,__awaiter:Tc,__generator:Ic,__createBinding:Rc,__exportStar:Ac,__values:fn,__read:Ai,__spread:Cc,__spreadArrays:Pc,__await:sr,__asyncGenerator:Lc,__asyncDelegator:Nc,__asyncValues:Uc,__makeTemplateObject:Mc,__importStar:jc,__importDefault:$c,__classPrivateFieldGet:Fc,__classPrivateFieldSet:Bc}),Ar=At(zc),or={},De={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var hn=function(e,t){return hn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},hn(e,t)};function Hc(e,t){hn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ln=function(){return ln=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ln.apply(this,arguments)};function Kc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Gc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(s=(i<3?c(s):i>3?c(t,r,s):c(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Vc(e,t){return function(r,n){t(r,n,e)}}function qc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Yc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(d){try{f(n.next(d))}catch(w){c(w)}}function h(d){try{f(n.throw(d))}catch(w){c(w)}}function f(d){d.done?s(d.value):i(d.value).then(u,h)}f((n=n.apply(e,t||[])).next())})}function Wc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(d){return h([f,d])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Xc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function kc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function dn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ci(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],c;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Jc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ci(arguments[t]));return e}function Zc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function ar(e){return this instanceof ar?(this.v=e,this):new ar(e)}function Qc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof ar?Promise.resolve(v.value.v).then(f,d):w(s[0][2],v)}function f(v){u("next",v)}function d(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function eu(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(c){return(r=!r)?{value:ar(e[i](c)),done:i==="return"}:s?s(c):c}:s}}function tu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof dn=="function"?dn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(c){return new Promise(function(u,h){c=e[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function ru(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function nu(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function iu(e){return e&&e.__esModule?e:{default:e}}function su(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function ou(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var au=Object.freeze({__proto__:null,__extends:Hc,get __assign(){return ln},__rest:Kc,__decorate:Gc,__param:Vc,__metadata:qc,__awaiter:Yc,__generator:Wc,__createBinding:Xc,__exportStar:kc,__values:dn,__read:Ci,__spread:Jc,__spreadArrays:Zc,__await:ar,__asyncGenerator:Qc,__asyncDelegator:eu,__asyncValues:tu,__makeTemplateObject:ru,__importStar:nu,__importDefault:iu,__classPrivateFieldGet:su,__classPrivateFieldSet:ou}),Cr=At(au),_n={},cr={},Pi;function cu(){if(Pi)return cr;Pi=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return cr.delay=e,cr}var Ct={},gn={},Pt={},Li;function uu(){return Li||(Li=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.ONE_THOUSAND=Pt.ONE_HUNDRED=void 0,Pt.ONE_HUNDRED=100,Pt.ONE_THOUSAND=1e3),Pt}var yn={},Ni;function fu(){return Ni||(Ni=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(yn)),yn}var Ui;function Mi(){return Ui||(Ui=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Cr;t.__exportStar(uu(),e),t.__exportStar(fu(),e)}(gn)),gn}var ji;function hu(){if(ji)return Ct;ji=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.fromMiliseconds=Ct.toMiliseconds=void 0;const e=Mi();function t(n){return n*e.ONE_THOUSAND}Ct.toMiliseconds=t;function r(n){return Math.floor(n/e.ONE_THOUSAND)}return Ct.fromMiliseconds=r,Ct}var $i;function lu(){return $i||($i=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Cr;t.__exportStar(cu(),e),t.__exportStar(hu(),e)}(_n)),_n}var Vt={},Fi;function du(){if(Fi)return Vt;Fi=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Vt.Watch=e,Vt.default=e,Vt}var pn={},ur={},Bi;function _u(){if(Bi)return ur;Bi=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.IWatch=void 0;class e{}return ur.IWatch=e,ur}var zi;function gu(){return zi||(zi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Cr.__exportStar(_u(),e)}(pn)),pn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Cr;t.__exportStar(lu(),e),t.__exportStar(du(),e),t.__exportStar(gu(),e),t.__exportStar(Mi(),e)})(De);var bn={},fr={};class Lt{}var yu=Object.freeze({__proto__:null,IEvents:Lt}),pu=At(yu),Hi;function bu(){if(Hi)return fr;Hi=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.IHeartBeat=void 0;const e=pu;class t extends e.IEvents{constructor(n){super()}}return fr.IHeartBeat=t,fr}var Ki;function Gi(){return Ki||(Ki=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Ar.__exportStar(bu(),e)}(bn)),bn}var vn={},Nt={},Vi;function vu(){if(Vi)return Nt;Vi=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.HEARTBEAT_EVENTS=Nt.HEARTBEAT_INTERVAL=void 0;const e=De;return Nt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Nt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Nt}var qi;function Yi(){return qi||(qi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Ar.__exportStar(vu(),e)}(vn)),vn}var Wi;function Eu(){if(Wi)return or;Wi=1,Object.defineProperty(or,"__esModule",{value:!0}),or.HeartBeat=void 0;const e=Ar,t=ut.exports,r=De,n=Gi(),i=Yi();class s extends n.IHeartBeat{constructor(u){super(u),this.events=new t.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=u?.interval||i.HEARTBEAT_INTERVAL}static init(u){return e.__awaiter(this,void 0,void 0,function*(){const h=new s(u);return yield h.init(),h})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,h){this.events.on(u,h)}once(u,h){this.events.once(u,h)}off(u,h){this.events.off(u,h)}removeListener(u,h){this.events.removeListener(u,h)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return or.HeartBeat=s,or}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ar;t.__exportStar(Eu(),e),t.__exportStar(Gi(),e),t.__exportStar(Yi(),e)})(ir);var Te={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var En=function(e,t){return En=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},En(e,t)};function wu(e,t){En(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var wn=function(){return wn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},wn.apply(this,arguments)};function mu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Du(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(s=(i<3?c(s):i>3?c(t,r,s):c(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Su(e,t){return function(r,n){t(r,n,e)}}function Ou(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function xu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(d){try{f(n.next(d))}catch(w){c(w)}}function h(d){try{f(n.throw(d))}catch(w){c(w)}}function f(d){d.done?s(d.value):i(d.value).then(u,h)}f((n=n.apply(e,t||[])).next())})}function Tu(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(d){return h([f,d])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Iu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Ru(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function mn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xi(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],c;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Au(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Xi(arguments[t]));return e}function Cu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function hr(e){return this instanceof hr?(this.v=e,this):new hr(e)}function Pu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof hr?Promise.resolve(v.value.v).then(f,d):w(s[0][2],v)}function f(v){u("next",v)}function d(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Lu(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(c){return(r=!r)?{value:hr(e[i](c)),done:i==="return"}:s?s(c):c}:s}}function Nu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof mn=="function"?mn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(c){return new Promise(function(u,h){c=e[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Uu(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Mu(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function ju(e){return e&&e.__esModule?e:{default:e}}function $u(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Fu(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Bu=Object.freeze({__proto__:null,__extends:wu,get __assign(){return wn},__rest:mu,__decorate:Du,__param:Su,__metadata:Ou,__awaiter:xu,__generator:Tu,__createBinding:Iu,__exportStar:Ru,__values:mn,__read:Xi,__spread:Au,__spreadArrays:Cu,__await:hr,__asyncGenerator:Pu,__asyncDelegator:Lu,__asyncValues:Nu,__makeTemplateObject:Uu,__importStar:Mu,__importDefault:ju,__classPrivateFieldGet:$u,__classPrivateFieldSet:Fu}),zu=At(Bu),Ut={},ki;function Ji(){return ki||(ki=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.PINO_CUSTOM_CONTEXT_KEY=Ut.PINO_LOGGER_DEFAULTS=void 0,Ut.PINO_LOGGER_DEFAULTS={level:"info"},Ut.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ut}var rt={},Zi;function Hu(){if(Zi)return rt;Zi=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.generateChildLogger=rt.formatChildLoggerContext=rt.getLoggerContext=rt.setBrowserLoggerContext=rt.getBrowserLoggerContext=rt.getDefaultLoggerOptions=void 0;const e=Ji();function t(u){return Object.assign(Object.assign({},u),{level:u?.level||e.PINO_LOGGER_DEFAULTS.level})}rt.getDefaultLoggerOptions=t;function r(u,h=e.PINO_CUSTOM_CONTEXT_KEY){return u[h]||""}rt.getBrowserLoggerContext=r;function n(u,h,f=e.PINO_CUSTOM_CONTEXT_KEY){return u[f]=h,u}rt.setBrowserLoggerContext=n;function i(u,h=e.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof u.bindings>"u"?f=r(u,h):f=u.bindings().context||"",f}rt.getLoggerContext=i;function s(u,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const d=i(u,f);return d.trim()?`${d}/${h}`:h}rt.formatChildLoggerContext=s;function c(u,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const d=s(u,h,f),w=u.child({context:d});return n(w,d,f)}return rt.generateChildLogger=c,rt}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pino=void 0;const t=zu,r=t.__importDefault(en);Object.defineProperty(e,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Ji(),e),t.__exportStar(Hu(),e)})(Te);class Ku extends Lt{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Gu extends Lt{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Vu{constructor(t,r){this.logger=t,this.core=r}}class qu extends Lt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Yu extends Lt{constructor(t){super()}}class Wu{constructor(t,r,n,i){this.core=t,this.logger=r,this.name=n}}class Xu extends Lt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class ku extends Lt{constructor(t,r){super(),this.core=t,this.logger=r}}function Qi(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}function Dn(e){return typeof e=="string"?e:JSON.stringify(e)}var Sn={},qt={},Pr={},Lr={};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.BrowserRandomSource=void 0;const es=65536;class Ju{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let n=0;n<r.length;n+=es)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,es)));return r}}Lr.BrowserRandomSource=Ju;function Zu(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Nr={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});function Qu(e){for(var t=0;t<e.length;t++)e[t]=0;return e}ot.wipe=Qu;var ef={},tf=Object.freeze({__proto__:null,default:ef}),rf=At(tf);Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.NodeRandomSource=void 0;const nf=ot;class sf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Zu<"u"){const t=rf;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,nf.wipe)(r),n}}Nr.NodeRandomSource=sf,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.SystemRandomSource=void 0;const of=Lr,af=Nr;class cf{constructor(){if(this.isAvailable=!1,this.name="",this._source=new of.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new af.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Pr.SystemRandomSource=cf;var ee={},ts={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(u,h){var f=u>>>16&65535,d=u&65535,w=h>>>16&65535,v=h&65535;return d*v+(f*v+d*w<<16>>>0)|0}e.mul=Math.imul||t;function r(u,h){return u+h|0}e.add=r;function n(u,h){return u-h|0}e.sub=n;function i(u,h){return u<<h|u>>>32-h}e.rotl=i;function s(u,h){return u<<32-h|u>>>h}e.rotr=s;function c(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}e.isInteger=Number.isInteger||c,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(u){return e.isInteger(u)&&u>=-e.MAX_SAFE_INTEGER&&u<=e.MAX_SAFE_INTEGER}})(ts),Object.defineProperty(ee,"__esModule",{value:!0});var rs=ts;function uf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}ee.readInt16BE=uf;function ff(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}ee.readUint16BE=ff;function hf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}ee.readInt16LE=hf;function lf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}ee.readUint16LE=lf;function ns(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}ee.writeUint16BE=ns,ee.writeInt16BE=ns;function is(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}ee.writeUint16LE=is,ee.writeInt16LE=is;function On(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}ee.readInt32BE=On;function xn(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}ee.readUint32BE=xn;function Tn(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}ee.readInt32LE=Tn;function In(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}ee.readUint32LE=In;function Ur(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}ee.writeUint32BE=Ur,ee.writeInt32BE=Ur;function Mr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}ee.writeUint32LE=Mr,ee.writeInt32LE=Mr;function df(e,t){t===void 0&&(t=0);var r=On(e,t),n=On(e,t+4);return r*4294967296+n-(n>>31)*4294967296}ee.readInt64BE=df;function _f(e,t){t===void 0&&(t=0);var r=xn(e,t),n=xn(e,t+4);return r*4294967296+n}ee.readUint64BE=_f;function gf(e,t){t===void 0&&(t=0);var r=Tn(e,t),n=Tn(e,t+4);return n*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=gf;function yf(e,t){t===void 0&&(t=0);var r=In(e,t),n=In(e,t+4);return n*4294967296+r}ee.readUint64LE=yf;function ss(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ur(e/4294967296>>>0,t,r),Ur(e>>>0,t,r+4),t}ee.writeUint64BE=ss,ee.writeInt64BE=ss;function os(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Mr(e>>>0,t,r),Mr(e/4294967296>>>0,t,r+4),t}ee.writeUint64LE=os,ee.writeInt64LE=os;function pf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}ee.readUintBE=pf;function bf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}ee.readUintLE=bf;function vf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!rs.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}ee.writeUintBE=vf;function Ef(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!rs.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}ee.writeUintLE=Ef;function wf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}ee.readFloat32BE=wf;function mf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}ee.readFloat32LE=mf;function Df(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}ee.readFloat64BE=Df;function Sf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}ee.readFloat64LE=Sf;function Of(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}ee.writeFloat32BE=Of;function xf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}ee.writeFloat32LE=xf;function Tf(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}ee.writeFloat64BE=Tf;function If(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}ee.writeFloat64LE=If,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=Pr,r=ee,n=ot;e.defaultRandomSource=new t.SystemRandomSource;function i(f,d=e.defaultRandomSource){return d.randomBytes(f)}e.randomBytes=i;function s(f=e.defaultRandomSource){const d=i(4,f),w=(0,r.readUint32LE)(d);return(0,n.wipe)(d),w}e.randomUint32=s;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(f,d=c,w=e.defaultRandomSource){if(d.length<2)throw new Error("randomString charset is too short");if(d.length>256)throw new Error("randomString charset is too long");let v="";const b=d.length,T=256-256%b;for(;f>0;){const U=i(Math.ceil(f*256/T),w);for(let L=0;L<U.length&&f>0;L++){const K=U[L];K<T&&(v+=d.charAt(K%b),f--)}(0,n.wipe)(U)}return v}e.randomString=u;function h(f,d=c,w=e.defaultRandomSource){const v=Math.ceil(f/(Math.log(d.length)/Math.LN2));return u(v,d,w)}e.randomStringForEntropy=h}(qt);var as={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ee,r=ot;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var d=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[d++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(d=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,d,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[d++],f--;return this},u.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,d=this._bufferLength,w=f/536870912|0,v=f<<3,b=f%128<112?128:256;this._buffer[d]=128;for(var T=d+1;T<b-8;T++)this._buffer[T]=0;t.writeUint32BE(w,this._buffer,b-8),t.writeUint32BE(v,this._buffer,b-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,b),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],h,T*8),t.writeUint32BE(this._stateLo[T],h,T*8+4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,h,f,d,w,v,b){for(var T=f[0],U=f[1],L=f[2],K=f[3],S=f[4],I=f[5],y=f[6],E=f[7],p=d[0],o=d[1],_=d[2],j=d[3],F=d[4],W=d[5],k=d[6],J=d[7],A,R,q,$,P,N,M,B;b>=128;){for(var re=0;re<16;re++){var z=8*re+v;u[re]=t.readUint32BE(w,z),h[re]=t.readUint32BE(w,z+4)}for(var re=0;re<80;re++){var Z=T,Y=U,oe=L,x=K,O=S,m=I,a=y,g=E,H=p,G=o,fe=_,ye=j,le=F,ve=W,Ue=k,Ce=J;if(A=E,R=J,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=(S>>>14|F<<32-14)^(S>>>18|F<<32-18)^(F>>>41-32|S<<32-(41-32)),R=(F>>>14|S<<32-14)^(F>>>18|S<<32-18)^(S>>>41-32|F<<32-(41-32)),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=S&I^~S&y,R=F&W^~F&k,P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=i[re*2],R=i[re*2+1],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=u[re%16],R=h[re%16],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,q=M&65535|B<<16,$=P&65535|N<<16,A=q,R=$,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=(T>>>28|p<<32-28)^(p>>>34-32|T<<32-(34-32))^(p>>>39-32|T<<32-(39-32)),R=(p>>>28|T<<32-28)^(T>>>34-32|p<<32-(34-32))^(T>>>39-32|p<<32-(39-32)),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=T&U^T&L^U&L,R=p&o^p&_^o&_,P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,g=M&65535|B<<16,Ce=P&65535|N<<16,A=x,R=ye,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=q,R=$,P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,x=M&65535|B<<16,ye=P&65535|N<<16,U=Z,L=Y,K=oe,S=x,I=O,y=m,E=a,T=g,o=H,_=G,j=fe,F=ye,W=le,k=ve,J=Ue,p=Ce,re%16===15)for(var z=0;z<16;z++)A=u[z],R=h[z],P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=u[(z+9)%16],R=h[(z+9)%16],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,q=u[(z+1)%16],$=h[(z+1)%16],A=(q>>>1|$<<32-1)^(q>>>8|$<<32-8)^q>>>7,R=($>>>1|q<<32-1)^($>>>8|q<<32-8)^($>>>7|q<<32-7),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,q=u[(z+14)%16],$=h[(z+14)%16],A=(q>>>19|$<<32-19)^($>>>61-32|q<<32-(61-32))^q>>>6,R=($>>>19|q<<32-19)^(q>>>61-32|$<<32-(61-32))^($>>>6|q<<32-6),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,u[z]=M&65535|B<<16,h[z]=P&65535|N<<16}A=T,R=p,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[0],R=d[0],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[0]=T=M&65535|B<<16,d[0]=p=P&65535|N<<16,A=U,R=o,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[1],R=d[1],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[1]=U=M&65535|B<<16,d[1]=o=P&65535|N<<16,A=L,R=_,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[2],R=d[2],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[2]=L=M&65535|B<<16,d[2]=_=P&65535|N<<16,A=K,R=j,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[3],R=d[3],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[3]=K=M&65535|B<<16,d[3]=j=P&65535|N<<16,A=S,R=F,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[4],R=d[4],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[4]=S=M&65535|B<<16,d[4]=F=P&65535|N<<16,A=I,R=W,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[5],R=d[5],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[5]=I=M&65535|B<<16,d[5]=W=P&65535|N<<16,A=y,R=k,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[6],R=d[6],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[6]=y=M&65535|B<<16,d[6]=k=P&65535|N<<16,A=E,R=J,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[7],R=d[7],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[7]=E=M&65535|B<<16,d[7]=J=P&65535|N<<16,v+=128,b-=128}return v}function c(u){var h=new n;h.update(u);var f=h.digest();return h.clean(),f}e.hash=c})(as),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=qt,r=as,n=ot;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function i(x){const O=new Float64Array(16);if(x)for(let m=0;m<x.length;m++)O[m]=x[m];return O}const s=new Uint8Array(32);s[0]=9;const c=i(),u=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),v=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(x,O){for(let m=0;m<16;m++)x[m]=O[m]|0}function T(x){let O=1;for(let m=0;m<16;m++){let a=x[m]+O+65535;O=Math.floor(a/65536),x[m]=a-O*65536}x[0]+=O-1+37*(O-1)}function U(x,O,m){const a=~(m-1);for(let g=0;g<16;g++){const H=a&(x[g]^O[g]);x[g]^=H,O[g]^=H}}function L(x,O){const m=i(),a=i();for(let g=0;g<16;g++)a[g]=O[g];T(a),T(a),T(a);for(let g=0;g<2;g++){m[0]=a[0]-65517;for(let G=1;G<15;G++)m[G]=a[G]-65535-(m[G-1]>>16&1),m[G-1]&=65535;m[15]=a[15]-32767-(m[14]>>16&1);const H=m[15]>>16&1;m[14]&=65535,U(a,m,1-H)}for(let g=0;g<16;g++)x[2*g]=a[g]&255,x[2*g+1]=a[g]>>8}function K(x,O){let m=0;for(let a=0;a<32;a++)m|=x[a]^O[a];return(1&m-1>>>8)-1}function S(x,O){const m=new Uint8Array(32),a=new Uint8Array(32);return L(m,x),L(a,O),K(m,a)}function I(x){const O=new Uint8Array(32);return L(O,x),O[0]&1}function y(x,O){for(let m=0;m<16;m++)x[m]=O[2*m]+(O[2*m+1]<<8);x[15]&=32767}function E(x,O,m){for(let a=0;a<16;a++)x[a]=O[a]+m[a]}function p(x,O,m){for(let a=0;a<16;a++)x[a]=O[a]-m[a]}function o(x,O,m){let a,g,H=0,G=0,fe=0,ye=0,le=0,ve=0,Ue=0,Ce=0,ge=0,de=0,he=0,ce=0,ae=0,se=0,ie=0,Q=0,ue=0,_e=0,te=0,pe=0,be=0,we=0,me=0,Ee=0,gt=0,vt=0,xt=0,at=0,jt=0,mr=0,Yr=0,Me=m[0],Pe=m[1],je=m[2],$e=m[3],Fe=m[4],Le=m[5],He=m[6],Ke=m[7],Ge=m[8],Ve=m[9],qe=m[10],ze=m[11],Be=m[12],Re=m[13],Ye=m[14],We=m[15];a=O[0],H+=a*Me,G+=a*Pe,fe+=a*je,ye+=a*$e,le+=a*Fe,ve+=a*Le,Ue+=a*He,Ce+=a*Ke,ge+=a*Ge,de+=a*Ve,he+=a*qe,ce+=a*ze,ae+=a*Be,se+=a*Re,ie+=a*Ye,Q+=a*We,a=O[1],G+=a*Me,fe+=a*Pe,ye+=a*je,le+=a*$e,ve+=a*Fe,Ue+=a*Le,Ce+=a*He,ge+=a*Ke,de+=a*Ge,he+=a*Ve,ce+=a*qe,ae+=a*ze,se+=a*Be,ie+=a*Re,Q+=a*Ye,ue+=a*We,a=O[2],fe+=a*Me,ye+=a*Pe,le+=a*je,ve+=a*$e,Ue+=a*Fe,Ce+=a*Le,ge+=a*He,de+=a*Ke,he+=a*Ge,ce+=a*Ve,ae+=a*qe,se+=a*ze,ie+=a*Be,Q+=a*Re,ue+=a*Ye,_e+=a*We,a=O[3],ye+=a*Me,le+=a*Pe,ve+=a*je,Ue+=a*$e,Ce+=a*Fe,ge+=a*Le,de+=a*He,he+=a*Ke,ce+=a*Ge,ae+=a*Ve,se+=a*qe,ie+=a*ze,Q+=a*Be,ue+=a*Re,_e+=a*Ye,te+=a*We,a=O[4],le+=a*Me,ve+=a*Pe,Ue+=a*je,Ce+=a*$e,ge+=a*Fe,de+=a*Le,he+=a*He,ce+=a*Ke,ae+=a*Ge,se+=a*Ve,ie+=a*qe,Q+=a*ze,ue+=a*Be,_e+=a*Re,te+=a*Ye,pe+=a*We,a=O[5],ve+=a*Me,Ue+=a*Pe,Ce+=a*je,ge+=a*$e,de+=a*Fe,he+=a*Le,ce+=a*He,ae+=a*Ke,se+=a*Ge,ie+=a*Ve,Q+=a*qe,ue+=a*ze,_e+=a*Be,te+=a*Re,pe+=a*Ye,be+=a*We,a=O[6],Ue+=a*Me,Ce+=a*Pe,ge+=a*je,de+=a*$e,he+=a*Fe,ce+=a*Le,ae+=a*He,se+=a*Ke,ie+=a*Ge,Q+=a*Ve,ue+=a*qe,_e+=a*ze,te+=a*Be,pe+=a*Re,be+=a*Ye,we+=a*We,a=O[7],Ce+=a*Me,ge+=a*Pe,de+=a*je,he+=a*$e,ce+=a*Fe,ae+=a*Le,se+=a*He,ie+=a*Ke,Q+=a*Ge,ue+=a*Ve,_e+=a*qe,te+=a*ze,pe+=a*Be,be+=a*Re,we+=a*Ye,me+=a*We,a=O[8],ge+=a*Me,de+=a*Pe,he+=a*je,ce+=a*$e,ae+=a*Fe,se+=a*Le,ie+=a*He,Q+=a*Ke,ue+=a*Ge,_e+=a*Ve,te+=a*qe,pe+=a*ze,be+=a*Be,we+=a*Re,me+=a*Ye,Ee+=a*We,a=O[9],de+=a*Me,he+=a*Pe,ce+=a*je,ae+=a*$e,se+=a*Fe,ie+=a*Le,Q+=a*He,ue+=a*Ke,_e+=a*Ge,te+=a*Ve,pe+=a*qe,be+=a*ze,we+=a*Be,me+=a*Re,Ee+=a*Ye,gt+=a*We,a=O[10],he+=a*Me,ce+=a*Pe,ae+=a*je,se+=a*$e,ie+=a*Fe,Q+=a*Le,ue+=a*He,_e+=a*Ke,te+=a*Ge,pe+=a*Ve,be+=a*qe,we+=a*ze,me+=a*Be,Ee+=a*Re,gt+=a*Ye,vt+=a*We,a=O[11],ce+=a*Me,ae+=a*Pe,se+=a*je,ie+=a*$e,Q+=a*Fe,ue+=a*Le,_e+=a*He,te+=a*Ke,pe+=a*Ge,be+=a*Ve,we+=a*qe,me+=a*ze,Ee+=a*Be,gt+=a*Re,vt+=a*Ye,xt+=a*We,a=O[12],ae+=a*Me,se+=a*Pe,ie+=a*je,Q+=a*$e,ue+=a*Fe,_e+=a*Le,te+=a*He,pe+=a*Ke,be+=a*Ge,we+=a*Ve,me+=a*qe,Ee+=a*ze,gt+=a*Be,vt+=a*Re,xt+=a*Ye,at+=a*We,a=O[13],se+=a*Me,ie+=a*Pe,Q+=a*je,ue+=a*$e,_e+=a*Fe,te+=a*Le,pe+=a*He,be+=a*Ke,we+=a*Ge,me+=a*Ve,Ee+=a*qe,gt+=a*ze,vt+=a*Be,xt+=a*Re,at+=a*Ye,jt+=a*We,a=O[14],ie+=a*Me,Q+=a*Pe,ue+=a*je,_e+=a*$e,te+=a*Fe,pe+=a*Le,be+=a*He,we+=a*Ke,me+=a*Ge,Ee+=a*Ve,gt+=a*qe,vt+=a*ze,xt+=a*Be,at+=a*Re,jt+=a*Ye,mr+=a*We,a=O[15],Q+=a*Me,ue+=a*Pe,_e+=a*je,te+=a*$e,pe+=a*Fe,be+=a*Le,we+=a*He,me+=a*Ke,Ee+=a*Ge,gt+=a*Ve,vt+=a*qe,xt+=a*ze,at+=a*Be,jt+=a*Re,mr+=a*Ye,Yr+=a*We,H+=38*ue,G+=38*_e,fe+=38*te,ye+=38*pe,le+=38*be,ve+=38*we,Ue+=38*me,Ce+=38*Ee,ge+=38*gt,de+=38*vt,he+=38*xt,ce+=38*at,ae+=38*jt,se+=38*mr,ie+=38*Yr,g=1,a=H+g+65535,g=Math.floor(a/65536),H=a-g*65536,a=G+g+65535,g=Math.floor(a/65536),G=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=ye+g+65535,g=Math.floor(a/65536),ye=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=ve+g+65535,g=Math.floor(a/65536),ve=a-g*65536,a=Ue+g+65535,g=Math.floor(a/65536),Ue=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ge+g+65535,g=Math.floor(a/65536),ge=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=he+g+65535,g=Math.floor(a/65536),he=a-g*65536,a=ce+g+65535,g=Math.floor(a/65536),ce=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ie+g+65535,g=Math.floor(a/65536),ie=a-g*65536,a=Q+g+65535,g=Math.floor(a/65536),Q=a-g*65536,H+=g-1+37*(g-1),g=1,a=H+g+65535,g=Math.floor(a/65536),H=a-g*65536,a=G+g+65535,g=Math.floor(a/65536),G=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=ye+g+65535,g=Math.floor(a/65536),ye=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=ve+g+65535,g=Math.floor(a/65536),ve=a-g*65536,a=Ue+g+65535,g=Math.floor(a/65536),Ue=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ge+g+65535,g=Math.floor(a/65536),ge=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=he+g+65535,g=Math.floor(a/65536),he=a-g*65536,a=ce+g+65535,g=Math.floor(a/65536),ce=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ie+g+65535,g=Math.floor(a/65536),ie=a-g*65536,a=Q+g+65535,g=Math.floor(a/65536),Q=a-g*65536,H+=g-1+37*(g-1),x[0]=H,x[1]=G,x[2]=fe,x[3]=ye,x[4]=le,x[5]=ve,x[6]=Ue,x[7]=Ce,x[8]=ge,x[9]=de,x[10]=he,x[11]=ce,x[12]=ae,x[13]=se,x[14]=ie,x[15]=Q}function _(x,O){o(x,O,O)}function j(x,O){const m=i();let a;for(a=0;a<16;a++)m[a]=O[a];for(a=253;a>=0;a--)_(m,m),a!==2&&a!==4&&o(m,m,O);for(a=0;a<16;a++)x[a]=m[a]}function F(x,O){const m=i();let a;for(a=0;a<16;a++)m[a]=O[a];for(a=250;a>=0;a--)_(m,m),a!==1&&o(m,m,O);for(a=0;a<16;a++)x[a]=m[a]}function W(x,O){const m=i(),a=i(),g=i(),H=i(),G=i(),fe=i(),ye=i(),le=i(),ve=i();p(m,x[1],x[0]),p(ve,O[1],O[0]),o(m,m,ve),E(a,x[0],x[1]),E(ve,O[0],O[1]),o(a,a,ve),o(g,x[3],O[3]),o(g,g,f),o(H,x[2],O[2]),E(H,H,H),p(G,a,m),p(fe,H,g),E(ye,H,g),E(le,a,m),o(x[0],G,fe),o(x[1],le,ye),o(x[2],ye,fe),o(x[3],G,le)}function k(x,O,m){for(let a=0;a<4;a++)U(x[a],O[a],m)}function J(x,O){const m=i(),a=i(),g=i();j(g,O[2]),o(m,O[0],g),o(a,O[1],g),L(x,a),x[31]^=I(m)<<7}function A(x,O,m){b(x[0],c),b(x[1],u),b(x[2],u),b(x[3],c);for(let a=255;a>=0;--a){const g=m[a/8|0]>>(a&7)&1;k(x,O,g),W(O,x),W(x,x),k(x,O,g)}}function R(x,O){const m=[i(),i(),i(),i()];b(m[0],d),b(m[1],w),b(m[2],u),o(m[3],d,w),A(x,m,O)}function q(x){if(x.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const O=(0,r.hash)(x);O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(32),a=[i(),i(),i(),i()];R(a,O),J(m,a);const g=new Uint8Array(64);return g.set(x),g.set(m,32),{publicKey:m,secretKey:g}}e.generateKeyPairFromSeed=q;function $(x){const O=(0,t.randomBytes)(32,x),m=q(O);return(0,n.wipe)(O),m}e.generateKeyPair=$;function P(x){if(x.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}e.extractPublicKeyFromSecretKey=P;const N=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(x,O){let m,a,g,H;for(a=63;a>=32;--a){for(m=0,g=a-32,H=a-12;g<H;++g)O[g]+=m-16*O[a]*N[g-(a-32)],m=Math.floor((O[g]+128)/256),O[g]-=m*256;O[g]+=m,O[a]=0}for(m=0,g=0;g<32;g++)O[g]+=m-(O[31]>>4)*N[g],m=O[g]>>8,O[g]&=255;for(g=0;g<32;g++)O[g]-=m*N[g];for(a=0;a<32;a++)O[a+1]+=O[a]>>8,x[a]=O[a]&255}function B(x){const O=new Float64Array(64);for(let m=0;m<64;m++)O[m]=x[m];for(let m=0;m<64;m++)x[m]=0;M(x,O)}function re(x,O){const m=new Float64Array(64),a=[i(),i(),i(),i()],g=(0,r.hash)(x.subarray(0,32));g[0]&=248,g[31]&=127,g[31]|=64;const H=new Uint8Array(64);H.set(g.subarray(32),32);const G=new r.SHA512;G.update(H.subarray(32)),G.update(O);const fe=G.digest();G.clean(),B(fe),R(a,fe),J(H,a),G.reset(),G.update(H.subarray(0,32)),G.update(x.subarray(32)),G.update(O);const ye=G.digest();B(ye);for(let le=0;le<32;le++)m[le]=fe[le];for(let le=0;le<32;le++)for(let ve=0;ve<32;ve++)m[le+ve]+=ye[le]*g[ve];return M(H.subarray(32),m),H}e.sign=re;function z(x,O){const m=i(),a=i(),g=i(),H=i(),G=i(),fe=i(),ye=i();return b(x[2],u),y(x[1],O),_(g,x[1]),o(H,g,h),p(g,g,x[2]),E(H,x[2],H),_(G,H),_(fe,G),o(ye,fe,G),o(m,ye,g),o(m,m,H),F(m,m),o(m,m,g),o(m,m,H),o(m,m,H),o(x[0],m,H),_(a,x[0]),o(a,a,H),S(a,g)&&o(x[0],x[0],v),_(a,x[0]),o(a,a,H),S(a,g)?-1:(I(x[0])===O[31]>>7&&p(x[0],c,x[0]),o(x[3],x[0],x[1]),0)}function Z(x,O,m){const a=new Uint8Array(32),g=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(m.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(z(H,x))return!1;const G=new r.SHA512;G.update(m.subarray(0,32)),G.update(x),G.update(O);const fe=G.digest();return B(fe),A(g,H,fe),R(H,m.subarray(32)),W(g,H),J(a,g),!K(m,a)}e.verify=Z;function Y(x){let O=[i(),i(),i(),i()];if(z(O,x))throw new Error("Ed25519: invalid public key");let m=i(),a=i(),g=O[1];E(m,u,g),p(a,u,g),j(a,a),o(m,m,a);let H=new Uint8Array(32);return L(H,m),H}e.convertPublicKeyToX25519=Y;function oe(x){const O=(0,r.hash)(x.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(O.subarray(0,32));return(0,n.wipe)(O),m}e.convertSecretKeyToX25519=oe}(Sn);const Rf="EdDSA",Af="JWT",cs=".",us="base64url",Cf="utf8",Pf="utf8",Lf=":",Nf="did",Uf="key",fs="base58btc",Mf="z",jf="K36",$f=32;function hs(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Rn(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const r=hs(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}function Ff(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),c=s.charCodeAt(0);if(r[c]!==255)throw new TypeError(s+" is ambiguous");r[c]=i}var u=e.length,h=e.charAt(0),f=Math.log(u)/Math.log(256),d=Math.log(256)/Math.log(u);function w(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var U=0,L=0,K=0,S=T.length;K!==S&&T[K]===0;)K++,U++;for(var I=(S-K)*d+1>>>0,y=new Uint8Array(I);K!==S;){for(var E=T[K],p=0,o=I-1;(E!==0||p<L)&&o!==-1;o--,p++)E+=256*y[o]>>>0,y[o]=E%u>>>0,E=E/u>>>0;if(E!==0)throw new Error("Non-zero carry");L=p,K++}for(var _=I-L;_!==I&&y[_]===0;)_++;for(var j=h.repeat(U);_<I;++_)j+=e.charAt(y[_]);return j}function v(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var U=0;if(T[U]!==" "){for(var L=0,K=0;T[U]===h;)L++,U++;for(var S=(T.length-U)*f+1>>>0,I=new Uint8Array(S);T[U];){var y=r[T.charCodeAt(U)];if(y===255)return;for(var E=0,p=S-1;(y!==0||E<K)&&p!==-1;p--,E++)y+=u*I[p]>>>0,I[p]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");K=E,U++}if(T[U]!==" "){for(var o=S-K;o!==S&&I[o]===0;)o++;for(var _=new Uint8Array(L+(S-o)),j=L;o!==S;)_[j++]=I[o++];return _}}}function b(T){var U=v(T);if(U)return U;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:v,decode:b}}var Bf=Ff,zf=Bf;const ls=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Hf=e=>new TextEncoder().encode(e),Kf=e=>new TextDecoder().decode(e);class Gf{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Vf{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ds(this,t)}}class qf{constructor(t){this.decoders=t}or(t){return ds(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ds=(e,t)=>new qf({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Yf{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Gf(t,r,n),this.decoder=new Vf(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const jr=({name:e,prefix:t,encode:r,decode:n})=>new Yf(e,t,r,n),lr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=zf(r,t);return jr({prefix:e,name:t,encode:n,decode:s=>ls(i(s))})},Wf=(e,t,r,n)=>{const i={};for(let d=0;d<t.length;++d)i[t[d]]=d;let s=e.length;for(;e[s-1]==="=";)--s;const c=new Uint8Array(s*r/8|0);let u=0,h=0,f=0;for(let d=0;d<s;++d){const w=i[e[d]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|w,u+=r,u>=8&&(u-=8,c[f++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return c},Xf=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",c=0,u=0;for(let h=0;h<e.length;++h)for(u=u<<8|e[h],c+=8;c>r;)c-=r,s+=t[i&u>>c];if(c&&(s+=t[i&u<<r-c]),n)for(;s.length*r&7;)s+="=";return s},Je=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>jr({prefix:t,name:e,encode(i){return Xf(i,n,r)},decode(i){return Wf(i,n,r,e)}}),kf=jr({prefix:"\0",name:"identity",encode:e=>Kf(e),decode:e=>Hf(e)});var Jf=Object.freeze({__proto__:null,identity:kf});const Zf=Je({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Qf=Object.freeze({__proto__:null,base2:Zf});const eh=Je({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var th=Object.freeze({__proto__:null,base8:eh});const rh=lr({prefix:"9",name:"base10",alphabet:"0123456789"});var nh=Object.freeze({__proto__:null,base10:rh});const ih=Je({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sh=Je({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var oh=Object.freeze({__proto__:null,base16:ih,base16upper:sh});const ah=Je({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ch=Je({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uh=Je({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),fh=Je({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hh=Je({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),lh=Je({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dh=Je({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_h=Je({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gh=Je({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var yh=Object.freeze({__proto__:null,base32:ah,base32upper:ch,base32pad:uh,base32padupper:fh,base32hex:hh,base32hexupper:lh,base32hexpad:dh,base32hexpadupper:_h,base32z:gh});const ph=lr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bh=lr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var vh=Object.freeze({__proto__:null,base36:ph,base36upper:bh});const Eh=lr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wh=lr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var mh=Object.freeze({__proto__:null,base58btc:Eh,base58flickr:wh});const Dh=Je({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Sh=Je({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Oh=Je({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xh=Je({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Th=Object.freeze({__proto__:null,base64:Dh,base64pad:Sh,base64url:Oh,base64urlpad:xh});const _s=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ih=_s.reduce((e,t,r)=>(e[r]=t,e),[]),Rh=_s.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function Ah(e){return e.reduce((t,r)=>(t+=Ih[r],t),"")}function Ch(e){const t=[];for(const r of e){const n=Rh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const Ph=jr({prefix:"\u{1F680}",name:"base256emoji",encode:Ah,decode:Ch});var Lh=Object.freeze({__proto__:null,base256emoji:Ph}),Nh=ys,gs=128,Uh=127,Mh=~Uh,jh=Math.pow(2,31);function ys(e,t,r){t=t||[],r=r||0;for(var n=r;e>=jh;)t[r++]=e&255|gs,e/=128;for(;e&Mh;)t[r++]=e&255|gs,e>>>=7;return t[r]=e|0,ys.bytes=r-n+1,t}var $h=An,Fh=128,ps=127;function An(e,n){var r=0,n=n||0,i=0,s=n,c,u=e.length;do{if(s>=u)throw An.bytes=0,new RangeError("Could not decode varint");c=e[s++],r+=i<28?(c&ps)<<i:(c&ps)*Math.pow(2,i),i+=7}while(c>=Fh);return An.bytes=s-n,r}var Bh=Math.pow(2,7),zh=Math.pow(2,14),Hh=Math.pow(2,21),Kh=Math.pow(2,28),Gh=Math.pow(2,35),Vh=Math.pow(2,42),qh=Math.pow(2,49),Yh=Math.pow(2,56),Wh=Math.pow(2,63),Xh=function(e){return e<Bh?1:e<zh?2:e<Hh?3:e<Kh?4:e<Gh?5:e<Vh?6:e<qh?7:e<Yh?8:e<Wh?9:10},kh={encode:Nh,decode:$h,encodingLength:Xh},bs=kh;const vs=(e,t,r=0)=>(bs.encode(e,t,r),t),Es=e=>bs.encodingLength(e),Cn=(e,t)=>{const r=t.byteLength,n=Es(e),i=n+Es(r),s=new Uint8Array(i+r);return vs(e,s,0),vs(r,s,n),s.set(t,i),new Jh(e,r,t,s)};class Jh{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const ws=({name:e,code:t,encode:r})=>new Zh(e,t,r);class Zh{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Cn(this.code,r):r.then(n=>Cn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ms=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Qh=ws({name:"sha2-256",code:18,encode:ms("SHA-256")}),el=ws({name:"sha2-512",code:19,encode:ms("SHA-512")});var tl=Object.freeze({__proto__:null,sha256:Qh,sha512:el});const Ds=0,rl="identity",Ss=ls;var nl=Object.freeze({__proto__:null,identity:{code:Ds,name:rl,encode:Ss,digest:e=>Cn(Ds,Ss(e))}});new TextEncoder,new TextDecoder;const Os={...Jf,...Qf,...th,...nh,...oh,...yh,...vh,...mh,...Th,...Lh};({...tl,...nl});function xs(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ts=xs("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Pn=xs("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=hs(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Is={utf8:Ts,"utf-8":Ts,hex:Os.base16,latin1:Pn,ascii:Pn,binary:Pn,...Os};function it(e,t="utf8"){const r=Is[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function nt(e,t="utf8"){const r=Is[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function $r(e){return it(nt(Dn(e),Cf),us)}function Rs(e){const t=nt(jf,fs),r=Mf+it(Rn([t,e]),fs);return[Nf,Uf,r].join(Lf)}function il(e){return it(e,us)}function sl(e){return nt([$r(e.header),$r(e.payload)].join(cs),Pf)}function ol(e){return[$r(e.header),$r(e.payload),il(e.signature)].join(cs)}function As(e=qt.randomBytes($f)){return Sn.generateKeyPairFromSeed(e)}async function al(e,t,r,n,i=De.fromMiliseconds(Date.now())){const s={alg:Rf,typ:Af},c=Rs(n.publicKey),u=i+r,h={iss:c,sub:e,aud:t,iat:i,exp:u},f=sl({header:s,payload:h}),d=Sn.sign(n.secretKey,f);return ol({header:s,payload:h,signature:d})}var Ln={},Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});var et=ee,Nn=ot,cl=20;function ul(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,c=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],d=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],v=r[23]<<24|r[22]<<16|r[21]<<8|r[20],b=r[27]<<24|r[26]<<16|r[25]<<8|r[24],T=r[31]<<24|r[30]<<16|r[29]<<8|r[28],U=t[3]<<24|t[2]<<16|t[1]<<8|t[0],L=t[7]<<24|t[6]<<16|t[5]<<8|t[4],K=t[11]<<24|t[10]<<16|t[9]<<8|t[8],S=t[15]<<24|t[14]<<16|t[13]<<8|t[12],I=n,y=i,E=s,p=c,o=u,_=h,j=f,F=d,W=w,k=v,J=b,A=T,R=U,q=L,$=K,P=S,N=0;N<cl;N+=2)I=I+o|0,R^=I,R=R>>>32-16|R<<16,W=W+R|0,o^=W,o=o>>>32-12|o<<12,y=y+_|0,q^=y,q=q>>>32-16|q<<16,k=k+q|0,_^=k,_=_>>>32-12|_<<12,E=E+j|0,$^=E,$=$>>>32-16|$<<16,J=J+$|0,j^=J,j=j>>>32-12|j<<12,p=p+F|0,P^=p,P=P>>>32-16|P<<16,A=A+P|0,F^=A,F=F>>>32-12|F<<12,E=E+j|0,$^=E,$=$>>>32-8|$<<8,J=J+$|0,j^=J,j=j>>>32-7|j<<7,p=p+F|0,P^=p,P=P>>>32-8|P<<8,A=A+P|0,F^=A,F=F>>>32-7|F<<7,y=y+_|0,q^=y,q=q>>>32-8|q<<8,k=k+q|0,_^=k,_=_>>>32-7|_<<7,I=I+o|0,R^=I,R=R>>>32-8|R<<8,W=W+R|0,o^=W,o=o>>>32-7|o<<7,I=I+_|0,P^=I,P=P>>>32-16|P<<16,J=J+P|0,_^=J,_=_>>>32-12|_<<12,y=y+j|0,R^=y,R=R>>>32-16|R<<16,A=A+R|0,j^=A,j=j>>>32-12|j<<12,E=E+F|0,q^=E,q=q>>>32-16|q<<16,W=W+q|0,F^=W,F=F>>>32-12|F<<12,p=p+o|0,$^=p,$=$>>>32-16|$<<16,k=k+$|0,o^=k,o=o>>>32-12|o<<12,E=E+F|0,q^=E,q=q>>>32-8|q<<8,W=W+q|0,F^=W,F=F>>>32-7|F<<7,p=p+o|0,$^=p,$=$>>>32-8|$<<8,k=k+$|0,o^=k,o=o>>>32-7|o<<7,y=y+j|0,R^=y,R=R>>>32-8|R<<8,A=A+R|0,j^=A,j=j>>>32-7|j<<7,I=I+_|0,P^=I,P=P>>>32-8|P<<8,J=J+P|0,_^=J,_=_>>>32-7|_<<7;et.writeUint32LE(I+n|0,e,0),et.writeUint32LE(y+i|0,e,4),et.writeUint32LE(E+s|0,e,8),et.writeUint32LE(p+c|0,e,12),et.writeUint32LE(o+u|0,e,16),et.writeUint32LE(_+h|0,e,20),et.writeUint32LE(j+f|0,e,24),et.writeUint32LE(F+d|0,e,28),et.writeUint32LE(W+w|0,e,32),et.writeUint32LE(k+v|0,e,36),et.writeUint32LE(J+b|0,e,40),et.writeUint32LE(A+T|0,e,44),et.writeUint32LE(R+U|0,e,48),et.writeUint32LE(q+L|0,e,52),et.writeUint32LE($+K|0,e,56),et.writeUint32LE(P+S|0,e,60)}function Cs(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,c;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),c=s.length-t.length,s.set(t,c)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,c=i}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){ul(u,s,e);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^u[f-h];hl(s,0,c)}return Nn.wipe(u),i===0&&Nn.wipe(s),n}Fr.streamXOR=Cs;function fl(e,t,r,n){return n===void 0&&(n=0),Nn.wipe(r),Cs(e,t,r,r,n)}Fr.stream=fl;function hl(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}var Ps={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});function ll(e,t,r){return~(e-1)&t|e-1&r}Ot.select=ll;function dl(e,t){return(e|0)-(t|0)-1>>>31&1}Ot.lessOrEqual=dl;function Ls(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Ot.compare=Ls;function _l(e,t){return e.length===0||t.length===0?!1:Ls(e,t)!==0}Ot.equal=_l,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Ot,r=ot;e.DIGEST_LENGTH=16;var n=function(){function c(u){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=u[0]|u[1]<<8;this._r[0]=h&8191;var f=u[2]|u[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var d=u[4]|u[5]<<8;this._r[2]=(f>>>10|d<<6)&7939;var w=u[6]|u[7]<<8;this._r[3]=(d>>>7|w<<9)&8191;var v=u[8]|u[9]<<8;this._r[4]=(w>>>4|v<<12)&255,this._r[5]=v>>>1&8190;var b=u[10]|u[11]<<8;this._r[6]=(v>>>14|b<<2)&8191;var T=u[12]|u[13]<<8;this._r[7]=(b>>>11|T<<5)&8065;var U=u[14]|u[15]<<8;this._r[8]=(T>>>8|U<<8)&8191,this._r[9]=U>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return c.prototype._blocks=function(u,h,f){for(var d=this._fin?0:2048,w=this._h[0],v=this._h[1],b=this._h[2],T=this._h[3],U=this._h[4],L=this._h[5],K=this._h[6],S=this._h[7],I=this._h[8],y=this._h[9],E=this._r[0],p=this._r[1],o=this._r[2],_=this._r[3],j=this._r[4],F=this._r[5],W=this._r[6],k=this._r[7],J=this._r[8],A=this._r[9];f>=16;){var R=u[h+0]|u[h+1]<<8;w+=R&8191;var q=u[h+2]|u[h+3]<<8;v+=(R>>>13|q<<3)&8191;var $=u[h+4]|u[h+5]<<8;b+=(q>>>10|$<<6)&8191;var P=u[h+6]|u[h+7]<<8;T+=($>>>7|P<<9)&8191;var N=u[h+8]|u[h+9]<<8;U+=(P>>>4|N<<12)&8191,L+=N>>>1&8191;var M=u[h+10]|u[h+11]<<8;K+=(N>>>14|M<<2)&8191;var B=u[h+12]|u[h+13]<<8;S+=(M>>>11|B<<5)&8191;var re=u[h+14]|u[h+15]<<8;I+=(B>>>8|re<<8)&8191,y+=re>>>5|d;var z=0,Z=z;Z+=w*E,Z+=v*(5*A),Z+=b*(5*J),Z+=T*(5*k),Z+=U*(5*W),z=Z>>>13,Z&=8191,Z+=L*(5*F),Z+=K*(5*j),Z+=S*(5*_),Z+=I*(5*o),Z+=y*(5*p),z+=Z>>>13,Z&=8191;var Y=z;Y+=w*p,Y+=v*E,Y+=b*(5*A),Y+=T*(5*J),Y+=U*(5*k),z=Y>>>13,Y&=8191,Y+=L*(5*W),Y+=K*(5*F),Y+=S*(5*j),Y+=I*(5*_),Y+=y*(5*o),z+=Y>>>13,Y&=8191;var oe=z;oe+=w*o,oe+=v*p,oe+=b*E,oe+=T*(5*A),oe+=U*(5*J),z=oe>>>13,oe&=8191,oe+=L*(5*k),oe+=K*(5*W),oe+=S*(5*F),oe+=I*(5*j),oe+=y*(5*_),z+=oe>>>13,oe&=8191;var x=z;x+=w*_,x+=v*o,x+=b*p,x+=T*E,x+=U*(5*A),z=x>>>13,x&=8191,x+=L*(5*J),x+=K*(5*k),x+=S*(5*W),x+=I*(5*F),x+=y*(5*j),z+=x>>>13,x&=8191;var O=z;O+=w*j,O+=v*_,O+=b*o,O+=T*p,O+=U*E,z=O>>>13,O&=8191,O+=L*(5*A),O+=K*(5*J),O+=S*(5*k),O+=I*(5*W),O+=y*(5*F),z+=O>>>13,O&=8191;var m=z;m+=w*F,m+=v*j,m+=b*_,m+=T*o,m+=U*p,z=m>>>13,m&=8191,m+=L*E,m+=K*(5*A),m+=S*(5*J),m+=I*(5*k),m+=y*(5*W),z+=m>>>13,m&=8191;var a=z;a+=w*W,a+=v*F,a+=b*j,a+=T*_,a+=U*o,z=a>>>13,a&=8191,a+=L*p,a+=K*E,a+=S*(5*A),a+=I*(5*J),a+=y*(5*k),z+=a>>>13,a&=8191;var g=z;g+=w*k,g+=v*W,g+=b*F,g+=T*j,g+=U*_,z=g>>>13,g&=8191,g+=L*o,g+=K*p,g+=S*E,g+=I*(5*A),g+=y*(5*J),z+=g>>>13,g&=8191;var H=z;H+=w*J,H+=v*k,H+=b*W,H+=T*F,H+=U*j,z=H>>>13,H&=8191,H+=L*_,H+=K*o,H+=S*p,H+=I*E,H+=y*(5*A),z+=H>>>13,H&=8191;var G=z;G+=w*A,G+=v*J,G+=b*k,G+=T*W,G+=U*F,z=G>>>13,G&=8191,G+=L*j,G+=K*_,G+=S*o,G+=I*p,G+=y*E,z+=G>>>13,G&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,Y+=z,w=Z,v=Y,b=oe,T=x,U=O,L=m,K=a,S=g,I=H,y=G,h+=16,f-=16}this._h[0]=w,this._h[1]=v,this._h[2]=b,this._h[3]=T,this._h[4]=U,this._h[5]=L,this._h[6]=K,this._h[7]=S,this._h[8]=I,this._h[9]=y},c.prototype.finish=function(u,h){h===void 0&&(h=0);var f=new Uint16Array(10),d,w,v,b;if(this._leftover){for(b=this._leftover,this._buffer[b++]=1;b<16;b++)this._buffer[b]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(d=this._h[1]>>>13,this._h[1]&=8191,b=2;b<10;b++)this._h[b]+=d,d=this._h[b]>>>13,this._h[b]&=8191;for(this._h[0]+=d*5,d=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=d,d=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=d,f[0]=this._h[0]+5,d=f[0]>>>13,f[0]&=8191,b=1;b<10;b++)f[b]=this._h[b]+d,d=f[b]>>>13,f[b]&=8191;for(f[9]-=1<<13,w=(d^1)-1,b=0;b<10;b++)f[b]&=w;for(w=~w,b=0;b<10;b++)this._h[b]=this._h[b]&w|f[b];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,v=this._h[0]+this._pad[0],this._h[0]=v&65535,b=1;b<8;b++)v=(this._h[b]+this._pad[b]|0)+(v>>>16)|0,this._h[b]=v&65535;return u[h+0]=this._h[0]>>>0,u[h+1]=this._h[0]>>>8,u[h+2]=this._h[1]>>>0,u[h+3]=this._h[1]>>>8,u[h+4]=this._h[2]>>>0,u[h+5]=this._h[2]>>>8,u[h+6]=this._h[3]>>>0,u[h+7]=this._h[3]>>>8,u[h+8]=this._h[4]>>>0,u[h+9]=this._h[4]>>>8,u[h+10]=this._h[5]>>>0,u[h+11]=this._h[5]>>>8,u[h+12]=this._h[6]>>>0,u[h+13]=this._h[6]>>>8,u[h+14]=this._h[7]>>>0,u[h+15]=this._h[7]>>>8,this._finished=!0,this},c.prototype.update=function(u){var h=0,f=u.length,d;if(this._leftover){d=16-this._leftover,d>f&&(d=f);for(var w=0;w<d;w++)this._buffer[this._leftover+w]=u[h+w];if(f-=d,h+=d,this._leftover+=d,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(d=f-f%16,this._blocks(u,h,d),h+=d,f-=d),f){for(var w=0;w<f;w++)this._buffer[this._leftover+w]=u[h+w];this._leftover+=f}return this},c.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},c.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},c}();e.Poly1305=n;function i(c,u){var h=new n(c);h.update(u);var f=h.digest();return h.clean(),f}e.oneTimeAuth=i;function s(c,u){return c.length!==e.DIGEST_LENGTH||u.length!==e.DIGEST_LENGTH?!1:t.equal(c,u)}e.equal=s}(Ps),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Fr,r=Ps,n=ot,i=ee,s=Ot;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var c=new Uint8Array(16),u=function(){function h(f){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,f.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,d,w,v){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var b=new Uint8Array(16);b.set(f,b.length-f.length);var T=new Uint8Array(32);t.stream(this._key,b,T,4);var U=d.length+this.tagLength,L;if(v){if(v.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");L=v}else L=new Uint8Array(U);return t.streamXOR(this._key,b,d,L,4),this._authenticate(L.subarray(L.length-this.tagLength,L.length),T,L.subarray(0,L.length-this.tagLength),w),n.wipe(b),L},h.prototype.open=function(f,d,w,v){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(d.length<this.tagLength)return null;var b=new Uint8Array(16);b.set(f,b.length-f.length);var T=new Uint8Array(32);t.stream(this._key,b,T,4);var U=new Uint8Array(this.tagLength);if(this._authenticate(U,T,d.subarray(0,d.length-this.tagLength),w),!s.equal(U,d.subarray(d.length-this.tagLength,d.length)))return null;var L=d.length-this.tagLength,K;if(v){if(v.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");K=v}else K=new Uint8Array(L);return t.streamXOR(this._key,b,d.subarray(0,d.length-this.tagLength),K,4),n.wipe(b),K},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,d,w,v){var b=new r.Poly1305(d);v&&(b.update(v),v.length%16>0&&b.update(c.subarray(v.length%16))),b.update(w),w.length%16>0&&b.update(c.subarray(w.length%16));var T=new Uint8Array(8);v&&i.writeUint64LE(v.length,T),b.update(T),i.writeUint64LE(w.length,T),b.update(T);for(var U=b.digest(),L=0;L<U.length;L++)f[L]=U[L];b.clean(),n.wipe(U),n.wipe(T)},h}();e.ChaCha20Poly1305=u}(Ln);var Ns={},dr={},Un={};Object.defineProperty(Un,"__esModule",{value:!0});function gl(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}Un.isSerializableHash=gl,Object.defineProperty(dr,"__esModule",{value:!0});var bt=Un,yl=Ot,pl=ot,Us=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),bt.isSerializableHash(this._inner)&&bt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),pl.wipe(n)}return e.prototype.reset=function(){if(!bt.isSerializableHash(this._inner)||!bt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){bt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),bt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!bt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!bt.isSerializableHash(this._inner)||!bt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!bt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();dr.HMAC=Us;function bl(e,t,r){var n=new Us(e,t);n.update(r);var i=n.digest();return n.clean(),i}dr.hmac=bl,dr.equal=yl.equal,Object.defineProperty(Ns,"__esModule",{value:!0});var Ms=dr,js=ot,vl=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=Ms.hmac(this._hash,n,r);this._hmac=new Ms.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),js.wipe(this._buffer),js.wipe(this._counter),this._bufpos=0},e}(),El=Ns.HKDF=vl,Br={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ee,r=ot;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var d=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[d++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(d=s(this._temp,this._state,h,d,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[d++],f--;return this},u.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,d=this._bufferLength,w=f/536870912|0,v=f<<3,b=f%64<56?64:128;this._buffer[d]=128;for(var T=d+1;T<b-8;T++)this._buffer[T]=0;t.writeUint32BE(w,this._buffer,b-8),t.writeUint32BE(v,this._buffer,b-4),s(this._temp,this._state,this._buffer,0,b),this._finished=!0}for(var T=0;T<this.digestLength/4;T++)t.writeUint32BE(this._state[T],h,T*4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,h,f,d,w){for(;w>=64;){for(var v=h[0],b=h[1],T=h[2],U=h[3],L=h[4],K=h[5],S=h[6],I=h[7],y=0;y<16;y++){var E=d+y*4;u[y]=t.readUint32BE(f,E)}for(var y=16;y<64;y++){var p=u[y-2],o=(p>>>17|p<<32-17)^(p>>>19|p<<32-19)^p>>>10;p=u[y-15];var _=(p>>>7|p<<32-7)^(p>>>18|p<<32-18)^p>>>3;u[y]=(o+u[y-7]|0)+(_+u[y-16]|0)}for(var y=0;y<64;y++){var o=(((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))+(L&K^~L&S)|0)+(I+(i[y]+u[y]|0)|0)|0,_=((v>>>2|v<<32-2)^(v>>>13|v<<32-13)^(v>>>22|v<<32-22))+(v&b^v&T^b&T)|0;I=S,S=K,K=L,L=U+o|0,U=T,T=b,b=v,v=o+_|0}h[0]+=v,h[1]+=b,h[2]+=T,h[3]+=U,h[4]+=L,h[5]+=K,h[6]+=S,h[7]+=I,d+=64,w-=64}return d}function c(u){var h=new n;h.update(u);var f=h.digest();return h.clean(),f}e.hash=c})(Br);var Mn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=qt,r=ot;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(y){const E=new Float64Array(16);if(y)for(let p=0;p<y.length;p++)E[p]=y[p];return E}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function c(y){let E=1;for(let p=0;p<16;p++){let o=y[p]+E+65535;E=Math.floor(o/65536),y[p]=o-E*65536}y[0]+=E-1+37*(E-1)}function u(y,E,p){const o=~(p-1);for(let _=0;_<16;_++){const j=o&(y[_]^E[_]);y[_]^=j,E[_]^=j}}function h(y,E){const p=n(),o=n();for(let _=0;_<16;_++)o[_]=E[_];c(o),c(o),c(o);for(let _=0;_<2;_++){p[0]=o[0]-65517;for(let F=1;F<15;F++)p[F]=o[F]-65535-(p[F-1]>>16&1),p[F-1]&=65535;p[15]=o[15]-32767-(p[14]>>16&1);const j=p[15]>>16&1;p[14]&=65535,u(o,p,1-j)}for(let _=0;_<16;_++)y[2*_]=o[_]&255,y[2*_+1]=o[_]>>8}function f(y,E){for(let p=0;p<16;p++)y[p]=E[2*p]+(E[2*p+1]<<8);y[15]&=32767}function d(y,E,p){for(let o=0;o<16;o++)y[o]=E[o]+p[o]}function w(y,E,p){for(let o=0;o<16;o++)y[o]=E[o]-p[o]}function v(y,E,p){let o,_,j=0,F=0,W=0,k=0,J=0,A=0,R=0,q=0,$=0,P=0,N=0,M=0,B=0,re=0,z=0,Z=0,Y=0,oe=0,x=0,O=0,m=0,a=0,g=0,H=0,G=0,fe=0,ye=0,le=0,ve=0,Ue=0,Ce=0,ge=p[0],de=p[1],he=p[2],ce=p[3],ae=p[4],se=p[5],ie=p[6],Q=p[7],ue=p[8],_e=p[9],te=p[10],pe=p[11],be=p[12],we=p[13],me=p[14],Ee=p[15];o=E[0],j+=o*ge,F+=o*de,W+=o*he,k+=o*ce,J+=o*ae,A+=o*se,R+=o*ie,q+=o*Q,$+=o*ue,P+=o*_e,N+=o*te,M+=o*pe,B+=o*be,re+=o*we,z+=o*me,Z+=o*Ee,o=E[1],F+=o*ge,W+=o*de,k+=o*he,J+=o*ce,A+=o*ae,R+=o*se,q+=o*ie,$+=o*Q,P+=o*ue,N+=o*_e,M+=o*te,B+=o*pe,re+=o*be,z+=o*we,Z+=o*me,Y+=o*Ee,o=E[2],W+=o*ge,k+=o*de,J+=o*he,A+=o*ce,R+=o*ae,q+=o*se,$+=o*ie,P+=o*Q,N+=o*ue,M+=o*_e,B+=o*te,re+=o*pe,z+=o*be,Z+=o*we,Y+=o*me,oe+=o*Ee,o=E[3],k+=o*ge,J+=o*de,A+=o*he,R+=o*ce,q+=o*ae,$+=o*se,P+=o*ie,N+=o*Q,M+=o*ue,B+=o*_e,re+=o*te,z+=o*pe,Z+=o*be,Y+=o*we,oe+=o*me,x+=o*Ee,o=E[4],J+=o*ge,A+=o*de,R+=o*he,q+=o*ce,$+=o*ae,P+=o*se,N+=o*ie,M+=o*Q,B+=o*ue,re+=o*_e,z+=o*te,Z+=o*pe,Y+=o*be,oe+=o*we,x+=o*me,O+=o*Ee,o=E[5],A+=o*ge,R+=o*de,q+=o*he,$+=o*ce,P+=o*ae,N+=o*se,M+=o*ie,B+=o*Q,re+=o*ue,z+=o*_e,Z+=o*te,Y+=o*pe,oe+=o*be,x+=o*we,O+=o*me,m+=o*Ee,o=E[6],R+=o*ge,q+=o*de,$+=o*he,P+=o*ce,N+=o*ae,M+=o*se,B+=o*ie,re+=o*Q,z+=o*ue,Z+=o*_e,Y+=o*te,oe+=o*pe,x+=o*be,O+=o*we,m+=o*me,a+=o*Ee,o=E[7],q+=o*ge,$+=o*de,P+=o*he,N+=o*ce,M+=o*ae,B+=o*se,re+=o*ie,z+=o*Q,Z+=o*ue,Y+=o*_e,oe+=o*te,x+=o*pe,O+=o*be,m+=o*we,a+=o*me,g+=o*Ee,o=E[8],$+=o*ge,P+=o*de,N+=o*he,M+=o*ce,B+=o*ae,re+=o*se,z+=o*ie,Z+=o*Q,Y+=o*ue,oe+=o*_e,x+=o*te,O+=o*pe,m+=o*be,a+=o*we,g+=o*me,H+=o*Ee,o=E[9],P+=o*ge,N+=o*de,M+=o*he,B+=o*ce,re+=o*ae,z+=o*se,Z+=o*ie,Y+=o*Q,oe+=o*ue,x+=o*_e,O+=o*te,m+=o*pe,a+=o*be,g+=o*we,H+=o*me,G+=o*Ee,o=E[10],N+=o*ge,M+=o*de,B+=o*he,re+=o*ce,z+=o*ae,Z+=o*se,Y+=o*ie,oe+=o*Q,x+=o*ue,O+=o*_e,m+=o*te,a+=o*pe,g+=o*be,H+=o*we,G+=o*me,fe+=o*Ee,o=E[11],M+=o*ge,B+=o*de,re+=o*he,z+=o*ce,Z+=o*ae,Y+=o*se,oe+=o*ie,x+=o*Q,O+=o*ue,m+=o*_e,a+=o*te,g+=o*pe,H+=o*be,G+=o*we,fe+=o*me,ye+=o*Ee,o=E[12],B+=o*ge,re+=o*de,z+=o*he,Z+=o*ce,Y+=o*ae,oe+=o*se,x+=o*ie,O+=o*Q,m+=o*ue,a+=o*_e,g+=o*te,H+=o*pe,G+=o*be,fe+=o*we,ye+=o*me,le+=o*Ee,o=E[13],re+=o*ge,z+=o*de,Z+=o*he,Y+=o*ce,oe+=o*ae,x+=o*se,O+=o*ie,m+=o*Q,a+=o*ue,g+=o*_e,H+=o*te,G+=o*pe,fe+=o*be,ye+=o*we,le+=o*me,ve+=o*Ee,o=E[14],z+=o*ge,Z+=o*de,Y+=o*he,oe+=o*ce,x+=o*ae,O+=o*se,m+=o*ie,a+=o*Q,g+=o*ue,H+=o*_e,G+=o*te,fe+=o*pe,ye+=o*be,le+=o*we,ve+=o*me,Ue+=o*Ee,o=E[15],Z+=o*ge,Y+=o*de,oe+=o*he,x+=o*ce,O+=o*ae,m+=o*se,a+=o*ie,g+=o*Q,H+=o*ue,G+=o*_e,fe+=o*te,ye+=o*pe,le+=o*be,ve+=o*we,Ue+=o*me,Ce+=o*Ee,j+=38*Y,F+=38*oe,W+=38*x,k+=38*O,J+=38*m,A+=38*a,R+=38*g,q+=38*H,$+=38*G,P+=38*fe,N+=38*ye,M+=38*le,B+=38*ve,re+=38*Ue,z+=38*Ce,_=1,o=j+_+65535,_=Math.floor(o/65536),j=o-_*65536,o=F+_+65535,_=Math.floor(o/65536),F=o-_*65536,o=W+_+65535,_=Math.floor(o/65536),W=o-_*65536,o=k+_+65535,_=Math.floor(o/65536),k=o-_*65536,o=J+_+65535,_=Math.floor(o/65536),J=o-_*65536,o=A+_+65535,_=Math.floor(o/65536),A=o-_*65536,o=R+_+65535,_=Math.floor(o/65536),R=o-_*65536,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=$+_+65535,_=Math.floor(o/65536),$=o-_*65536,o=P+_+65535,_=Math.floor(o/65536),P=o-_*65536,o=N+_+65535,_=Math.floor(o/65536),N=o-_*65536,o=M+_+65535,_=Math.floor(o/65536),M=o-_*65536,o=B+_+65535,_=Math.floor(o/65536),B=o-_*65536,o=re+_+65535,_=Math.floor(o/65536),re=o-_*65536,o=z+_+65535,_=Math.floor(o/65536),z=o-_*65536,o=Z+_+65535,_=Math.floor(o/65536),Z=o-_*65536,j+=_-1+37*(_-1),_=1,o=j+_+65535,_=Math.floor(o/65536),j=o-_*65536,o=F+_+65535,_=Math.floor(o/65536),F=o-_*65536,o=W+_+65535,_=Math.floor(o/65536),W=o-_*65536,o=k+_+65535,_=Math.floor(o/65536),k=o-_*65536,o=J+_+65535,_=Math.floor(o/65536),J=o-_*65536,o=A+_+65535,_=Math.floor(o/65536),A=o-_*65536,o=R+_+65535,_=Math.floor(o/65536),R=o-_*65536,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=$+_+65535,_=Math.floor(o/65536),$=o-_*65536,o=P+_+65535,_=Math.floor(o/65536),P=o-_*65536,o=N+_+65535,_=Math.floor(o/65536),N=o-_*65536,o=M+_+65535,_=Math.floor(o/65536),M=o-_*65536,o=B+_+65535,_=Math.floor(o/65536),B=o-_*65536,o=re+_+65535,_=Math.floor(o/65536),re=o-_*65536,o=z+_+65535,_=Math.floor(o/65536),z=o-_*65536,o=Z+_+65535,_=Math.floor(o/65536),Z=o-_*65536,j+=_-1+37*(_-1),y[0]=j,y[1]=F,y[2]=W,y[3]=k,y[4]=J,y[5]=A,y[6]=R,y[7]=q,y[8]=$,y[9]=P,y[10]=N,y[11]=M,y[12]=B,y[13]=re,y[14]=z,y[15]=Z}function b(y,E){v(y,E,E)}function T(y,E){const p=n();for(let o=0;o<16;o++)p[o]=E[o];for(let o=253;o>=0;o--)b(p,p),o!==2&&o!==4&&v(p,p,E);for(let o=0;o<16;o++)y[o]=p[o]}function U(y,E){const p=new Uint8Array(32),o=new Float64Array(80),_=n(),j=n(),F=n(),W=n(),k=n(),J=n();for(let $=0;$<31;$++)p[$]=y[$];p[31]=y[31]&127|64,p[0]&=248,f(o,E);for(let $=0;$<16;$++)j[$]=o[$];_[0]=W[0]=1;for(let $=254;$>=0;--$){const P=p[$>>>3]>>>($&7)&1;u(_,j,P),u(F,W,P),d(k,_,F),w(_,_,F),d(F,j,W),w(j,j,W),b(W,k),b(J,_),v(_,F,_),v(F,j,k),d(k,_,F),w(_,_,F),b(j,_),w(F,W,J),v(_,F,s),d(_,_,W),v(F,F,_),v(_,W,J),v(W,j,o),b(j,k),u(_,j,P),u(F,W,P)}for(let $=0;$<16;$++)o[$+16]=_[$],o[$+32]=F[$],o[$+48]=j[$],o[$+64]=W[$];const A=o.subarray(32),R=o.subarray(16);T(A,A),v(R,R,A);const q=new Uint8Array(32);return h(q,R),q}e.scalarMult=U;function L(y){return U(y,i)}e.scalarMultBase=L;function K(y){if(y.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(y);return{publicKey:L(E),secretKey:E}}e.generateKeyPairFromSeed=K;function S(y){const E=(0,t.randomBytes)(32,y),p=K(E);return(0,r.wipe)(E),p}e.generateKeyPair=S;function I(y,E,p=!1){if(y.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=U(y,E);if(p){let _=0;for(let j=0;j<o.length;j++)_|=o[j];if(_===0)throw new Error("X25519: invalid shared key")}return o}e.sharedKey=I})(Mn);var $s=function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},wl=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),ml=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),Dl=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),Sl=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),Ol=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),xl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Tl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Fs=3,Il=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",xl]],Bs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Rl(e){return e?zs(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Ol:typeof navigator<"u"?zs(navigator.userAgent):Pl()}function Al(e){return e!==""&&Il.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]},!1)}function zs(e){var t=Al(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new Sl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Fs&&(i=$s($s([],i,!0),Ll(Fs-i.length),!0)):i=[];var s=i.join("."),c=Cl(e),u=Tl.exec(e);return u&&u[1]?new Dl(r,s,c,u[1]):new wl(r,s,c)}function Cl(e){for(var t=0,r=Bs.length;t<r;t++){var n=Bs[t],i=n[0],s=n[1],c=s.exec(e);if(c)return i}return null}function Pl(){var e=typeof process<"u"&&process.version;return e?new ml(process.version.slice(1)):null}function Ll(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Ks=Oe.getLocation=Oe.getLocationOrThrow=jn=Oe.getNavigator=Oe.getNavigatorOrThrow=Hs=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Mt(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}Oe.getFromWindow=Mt;function Yt(e){const t=Mt(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Oe.getFromWindowOrThrow=Yt;function Nl(){return Yt("document")}Oe.getDocumentOrThrow=Nl;function Ul(){return Mt("document")}var Hs=Oe.getDocument=Ul;function Ml(){return Yt("navigator")}Oe.getNavigatorOrThrow=Ml;function jl(){return Mt("navigator")}var jn=Oe.getNavigator=jl;function $l(){return Yt("location")}Oe.getLocationOrThrow=$l;function Fl(){return Mt("location")}var Ks=Oe.getLocation=Fl;function Bl(){return Yt("crypto")}Oe.getCryptoOrThrow=Bl;function zl(){return Mt("crypto")}Oe.getCrypto=zl;function Hl(){return Yt("localStorage")}Oe.getLocalStorageOrThrow=Hl;function Kl(){return Mt("localStorage")}Oe.getLocalStorage=Kl;var $n={};Object.defineProperty($n,"__esModule",{value:!0}),$n.getWindowMetadata=void 0;const Gs=Oe;function Gl(){let e,t;try{e=Gs.getDocumentOrThrow(),t=Gs.getLocationOrThrow()}catch{return null}function r(){const w=e.getElementsByTagName("link"),v=[];for(let b=0;b<w.length;b++){const T=w[b],U=T.getAttribute("rel");if(U&&U.toLowerCase().indexOf("icon")>-1){const L=T.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let K=t.protocol+"//"+t.host;if(L.indexOf("/")===0)K+=L;else{const S=t.pathname.split("/");S.pop();const I=S.join("/");K+=I+"/"+L}v.push(K)}else if(L.indexOf("//")===0){const K=t.protocol+L;v.push(K)}else v.push(L)}}return v}function n(...w){const v=e.getElementsByTagName("meta");for(let b=0;b<v.length;b++){const T=v[b],U=["itemprop","property","name"].map(L=>T.getAttribute(L)).filter(L=>L?w.includes(L):!1);if(U.length&&U){const L=T.getAttribute("content");if(L)return L}}return""}function i(){let w=n("name","og:site_name","og:title","twitter:title");return w||(w=e.title),w}function s(){return n("description","og:description","twitter:description","keywords")}const c=i(),u=s(),h=t.origin,f=r();return{description:u,url:h,icons:f,name:c}}$n.getWindowMetadata=Gl;var _r={},Vl=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Vs="%[a-f0-9]{2}",qs=new RegExp("("+Vs+")|([^%]+?)","gi"),Ys=new RegExp("("+Vs+")+","gi");function Fn(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],Fn(r),Fn(n))}function ql(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(qs)||[],r=1;r<t.length;r++)e=Fn(t,r).join(""),t=e.match(qs)||[];return e}}function Yl(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Ys.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var n=ql(r[0]);n!==r[0]&&(t[r[0]]=n)}r=Ys.exec(e)}t["%C2"]="\uFFFD";for(var i=Object.keys(t),s=0;s<i.length;s++){var c=i[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}var Wl=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return Yl(e)}},Xl=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},kl=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),s=0;s<n.length;s++){var c=n[s],u=e[c];(i?t.indexOf(c)!==-1:t(c,u,e))&&(r[c]=u)}return r};(function(e){const t=Vl,r=Wl,n=Xl,i=kl,s=S=>S==null,c=Symbol("encodeFragmentIdentifier");function u(S){switch(S.arrayFormat){case"index":return I=>(y,E)=>{const p=y.length;return E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,[d(I,S),"[",p,"]"].join("")]:[...y,[d(I,S),"[",d(p,S),"]=",d(E,S)].join("")]};case"bracket":return I=>(y,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,[d(I,S),"[]"].join("")]:[...y,[d(I,S),"[]=",d(E,S)].join("")];case"colon-list-separator":return I=>(y,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,[d(I,S),":list="].join("")]:[...y,[d(I,S),":list=",d(E,S)].join("")];case"comma":case"separator":case"bracket-separator":{const I=S.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(E,p)=>p===void 0||S.skipNull&&p===null||S.skipEmptyString&&p===""?E:(p=p===null?"":p,E.length===0?[[d(y,S),I,d(p,S)].join("")]:[[E,d(p,S)].join(S.arrayFormatSeparator)])}default:return I=>(y,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,d(I,S)]:[...y,[d(I,S),"=",d(E,S)].join("")]}}function h(S){let I;switch(S.arrayFormat){case"index":return(y,E,p)=>{if(I=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!I){p[y]=E;return}p[y]===void 0&&(p[y]={}),p[y][I[1]]=E};case"bracket":return(y,E,p)=>{if(I=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!I){p[y]=E;return}if(p[y]===void 0){p[y]=[E];return}p[y]=[].concat(p[y],E)};case"colon-list-separator":return(y,E,p)=>{if(I=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!I){p[y]=E;return}if(p[y]===void 0){p[y]=[E];return}p[y]=[].concat(p[y],E)};case"comma":case"separator":return(y,E,p)=>{const o=typeof E=="string"&&E.includes(S.arrayFormatSeparator),_=typeof E=="string"&&!o&&w(E,S).includes(S.arrayFormatSeparator);E=_?w(E,S):E;const j=o||_?E.split(S.arrayFormatSeparator).map(F=>w(F,S)):E===null?E:w(E,S);p[y]=j};case"bracket-separator":return(y,E,p)=>{const o=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!o){p[y]=E&&w(E,S);return}const _=E===null?[]:E.split(S.arrayFormatSeparator).map(j=>w(j,S));if(p[y]===void 0){p[y]=_;return}p[y]=[].concat(p[y],_)};default:return(y,E,p)=>{if(p[y]===void 0){p[y]=E;return}p[y]=[].concat(p[y],E)}}}function f(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function d(S,I){return I.encode?I.strict?t(S):encodeURIComponent(S):S}function w(S,I){return I.decode?r(S):S}function v(S){return Array.isArray(S)?S.sort():typeof S=="object"?v(Object.keys(S)).sort((I,y)=>Number(I)-Number(y)).map(I=>S[I]):S}function b(S){const I=S.indexOf("#");return I!==-1&&(S=S.slice(0,I)),S}function T(S){let I="";const y=S.indexOf("#");return y!==-1&&(I=S.slice(y)),I}function U(S){S=b(S);const I=S.indexOf("?");return I===-1?"":S.slice(I+1)}function L(S,I){return I.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):I.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function K(S,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),f(I.arrayFormatSeparator);const y=h(I),E=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return E;for(const p of S.split("&")){if(p==="")continue;let[o,_]=n(I.decode?p.replace(/\+/g," "):p,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?_:w(_,I),y(w(o,I),_,E)}for(const p of Object.keys(E)){const o=E[p];if(typeof o=="object"&&o!==null)for(const _ of Object.keys(o))o[_]=L(o[_],I);else E[p]=L(o,I)}return I.sort===!1?E:(I.sort===!0?Object.keys(E).sort():Object.keys(E).sort(I.sort)).reduce((p,o)=>{const _=E[o];return Boolean(_)&&typeof _=="object"&&!Array.isArray(_)?p[o]=v(_):p[o]=_,p},Object.create(null))}e.extract=U,e.parse=K,e.stringify=(S,I)=>{if(!S)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),f(I.arrayFormatSeparator);const y=_=>I.skipNull&&s(S[_])||I.skipEmptyString&&S[_]==="",E=u(I),p={};for(const _ of Object.keys(S))y(_)||(p[_]=S[_]);const o=Object.keys(p);return I.sort!==!1&&o.sort(I.sort),o.map(_=>{const j=S[_];return j===void 0?"":j===null?d(_,I):Array.isArray(j)?j.length===0&&I.arrayFormat==="bracket-separator"?d(_,I)+"[]":j.reduce(E(_),[]).join("&"):d(_,I)+"="+d(j,I)}).filter(_=>_.length>0).join("&")},e.parseUrl=(S,I)=>{I=Object.assign({decode:!0},I);const[y,E]=n(S,"#");return Object.assign({url:y.split("?")[0]||"",query:K(U(S),I)},I&&I.parseFragmentIdentifier&&E?{fragmentIdentifier:w(E,I)}:{})},e.stringifyUrl=(S,I)=>{I=Object.assign({encode:!0,strict:!0,[c]:!0},I);const y=b(S.url).split("?")[0]||"",E=e.extract(S.url),p=e.parse(E,{sort:!1}),o=Object.assign(p,S.query);let _=e.stringify(o,I);_&&(_=`?${_}`);let j=T(S.url);return S.fragmentIdentifier&&(j=`#${I[c]?d(S.fragmentIdentifier,I):S.fragmentIdentifier}`),`${y}${_}${j}`},e.pick=(S,I,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[c]:!1},y);const{url:E,query:p,fragmentIdentifier:o}=e.parseUrl(S,y);return e.stringifyUrl({url:E,query:i(p,I),fragmentIdentifier:o},y)},e.exclude=(S,I,y)=>{const E=Array.isArray(I)?p=>!I.includes(p):(p,o)=>!I(p,o);return e.pick(S,E,y)}})(_r);const Jl={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Ws="base10",st="base16",Bn="base64pad",zn="utf8",Xs=0,Wt=1,Zl=0,ks=1,Hn=12,Kn=32;function Ql(){const e=Mn.generateKeyPair();return{privateKey:it(e.secretKey,st),publicKey:it(e.publicKey,st)}}function Gn(){const e=qt.randomBytes(Kn);return it(e,st)}function ed(e,t){const r=Mn.sharedKey(nt(e,st),nt(t,st)),n=new El(Br.SHA256,r).expand(Kn);return it(n,st)}function Js(e){const t=Br.hash(nt(e,st));return it(t,st)}function zr(e){const t=Br.hash(nt(e,zn));return it(t,st)}function td(e){return nt(`${e}`,Ws)}function gr(e){return Number(it(e,Ws))}function rd(e){const t=td(typeof e.type<"u"?e.type:Xs);if(gr(t)===Wt&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?nt(e.senderPublicKey,st):void 0,n=typeof e.iv<"u"?nt(e.iv,st):qt.randomBytes(Hn),i=new Ln.ChaCha20Poly1305(nt(e.symKey,st)).seal(n,nt(e.message,zn));return id({type:t,sealed:i,iv:n,senderPublicKey:r})}function nd(e){const t=new Ln.ChaCha20Poly1305(nt(e.symKey,st)),{sealed:r,iv:n}=Vn(e.encoded),i=t.open(n,r);if(i===null)throw new Error("Failed to decrypt");return it(i,zn)}function id(e){if(gr(e.type)===Wt){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return it(Rn([e.type,e.senderPublicKey,e.iv,e.sealed]),Bn)}return it(Rn([e.type,e.iv,e.sealed]),Bn)}function Vn(e){const t=nt(e,Bn),r=t.slice(Zl,ks),n=ks;if(gr(r)===Wt){const u=n+Kn,h=u+Hn,f=t.slice(n,u),d=t.slice(u,h),w=t.slice(h);return{type:r,sealed:w,iv:d,senderPublicKey:f}}const i=n+Hn,s=t.slice(n,i),c=t.slice(i);return{type:r,sealed:c,iv:s}}function sd(e,t){const r=Vn(e);return Zs({type:gr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?it(r.senderPublicKey,st):void 0,receiverPublicKey:t?.receiverPublicKey})}function Zs(e){const t=e?.type||Xs;if(t===Wt){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Qs(e){return e.type===Wt&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var od=Object.defineProperty,eo=Object.getOwnPropertySymbols,ad=Object.prototype.hasOwnProperty,cd=Object.prototype.propertyIsEnumerable,to=(e,t,r)=>t in e?od(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ro=(e,t)=>{for(var r in t||(t={}))ad.call(t,r)&&to(e,r,t[r]);if(eo)for(var r of eo(t))cd.call(t,r)&&to(e,r,t[r]);return e};const ud="ReactNative",yr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},fd="js";function no(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function hd(){return!Hs()&&!!jn()&&navigator.product===ud}function ld(){return!no()&&!!jn()}function dd(){return hd()?yr.reactNative:no()?yr.node:ld()?yr.browser:yr.unknown}function _d(e,t){let r=_r.parse(e);return r=ro(ro({},r),t),e=_r.stringify(r),e}function gd(){const e=Rl();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function yd(){var e;const t=dd();return t===yr.browser?[t,((e=Ks())==null?void 0:e.host)||"unknown"].join(":"):t}function pd(e,t,r){const n=gd(),i=yd();return[[e,t].join("-"),[fd,r].join("-"),n,i].join("/")}function bd({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const c=r.split("?"),u=pd(e,t,n),h={auth:i,ua:u,projectId:s},f=_d(c[1]||"",h);return c[0]+"?"+f}function io(e){return Object.fromEntries(e.entries())}function so(e){return new Map(Object.entries(e))}function vd(e=De.FIVE_MINUTES,t){const r=De.toMiliseconds(e||De.FIVE_MINUTES);let n,i,s;return{resolve:c=>{s&&n&&(clearTimeout(s),n(c))},reject:c=>{s&&i&&(clearTimeout(s),i(c))},done:()=>new Promise((c,u)=>{s=setTimeout(()=>{u(new Error(t))},r),n=c,i=u})}}function qn(e,t){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),t),s=await e;clearTimeout(i),r(s)})}function oo(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Ed(e){return oo("topic",e)}function wd(e){return oo("id",e)}function md(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function Yn(e,t){return De.fromMiliseconds((t||Date.now())+De.toMiliseconds(e))}function ao(e){return Date.now()>=De.toMiliseconds(e)}function Wn(e,t){return`${e}${t?`:${t}`:""}`}const Dd="irn";function Xn(e){return e?.relay||{protocol:Dd}}function Hr(e){const t=Jl[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Sd=Object.defineProperty,co=Object.getOwnPropertySymbols,Od=Object.prototype.hasOwnProperty,xd=Object.prototype.propertyIsEnumerable,uo=(e,t,r)=>t in e?Sd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Td=(e,t)=>{for(var r in t||(t={}))Od.call(t,r)&&uo(e,r,t[r]);if(co)for(var r of co(t))xd.call(t,r)&&uo(e,r,t[r]);return e};function Id(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),c=e[i];r[s]=c}}),r}function Rd(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=i[0],c=typeof r<"u"?e.substring(r):"",u=_r.parse(c),h=u.symKey;if(h.length!==64)throw new Error(`Invalid symKey: ${h}`);const f=Js(h);if(s!==f)throw new Error(`Invalid topic: ${s}`);return{protocol:n,topic:s,version:parseInt(i[1],10),symKey:h,relay:Id(u)}}function Ad(e,t="-"){const r="relay",n={};return Object.keys(e).forEach(i=>{const s=r+t+i;e[i]&&(n[s]=e[i])}),n}function Cd(e){return`${e.protocol}:${e.topic}@${e.version}?`+_r.stringify(Td({symKey:e.symKey},Ad(e.relay)))}const Pd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ld={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function xe(e,t){const{message:r,code:n}=Ld[e];return{message:t?`${r} ${t}`:r,code:n}}function pr(e,t){const{message:r,code:n}=Pd[e];return{message:t?`${r} ${t}`:r,code:n}}function Kr(e){return typeof e>"u"}function fo(e,t){return t&&Kr(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function Nd(e){if(fo(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function Ud(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function Md(e){return e?.topic}function kn(e){return typeof e<"u"&&typeof e!==null}const Jn="wc",ho=2,Gr="core",Et=`${Jn}@${2}:${Gr}:`,lo={name:Gr,logger:"error"},_o={database:":memory:"},go="crypto",Zn="client_ed25519_seed",yo=De.ONE_DAY,po="keychain",bo="0.3",vo="messages",Eo="0.3",wo=De.SIX_HOURS,mo="publisher",Do="irn",So="error",Qn="wss://relay.walletconnect.com",Oo="relayer",Ze={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},xo="_subscription",br={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ei=De.ONE_SECOND,jd={database:":memory:"},To="2.4.7",Io="0.3",dt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},$d=De.THIRTY_DAYS,Ro="subscription",Ao="0.3",Co=De.FIVE_SECONDS*1e3,Po="pairing",Lo="0.3",Fd=De.THIRTY_DAYS,Xt={wc_pairingDelete:{req:{ttl:De.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:De.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:De.ONE_DAY,prompt:!1,tag:0},res:{ttl:De.ONE_DAY,prompt:!1,tag:0}}},_t={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},No="history",Uo="0.3",Mo="expirer",ft={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},jo="0.3",Bd=De.ONE_DAY;class $o{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=po,this.version=bo,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=xe("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,io(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?so(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Fo{constructor(t,r,n){this.core=t,this.logger=r,this.name=go,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=As(i);return Rs(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Ql();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),c=As(s),u=Gn();return await al(u,i,yo,c)},this.generateSharedKey=(i,s,c)=>{this.isInitialized();const u=this.getPrivateKey(i),h=ed(u,s);return this.setSymKey(h,c)},this.setSymKey=async(i,s)=>{this.isInitialized();const c=s||Js(i);return await this.keychain.set(c,i),c},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,c)=>{this.isInitialized();const u=Zs(c),h=Dn(s);if(Qs(u)){const v=u.senderPublicKey,b=u.receiverPublicKey;i=await this.generateSharedKey(v,b)}const f=this.getSymKey(i),{type:d,senderPublicKey:w}=u;return rd({type:d,symKey:f,message:h,senderPublicKey:w})},this.decode=async(i,s,c)=>{this.isInitialized();const u=sd(s,c);if(Qs(u)){const d=u.receiverPublicKey,w=u.senderPublicKey;i=await this.generateSharedKey(d,w)}const h=this.getSymKey(i),f=nd({symKey:h,encoded:s});return Qi(f)},this.core=t,this.logger=Te.generateChildLogger(r,this.name),this.keychain=n||new $o(this.core,this.logger)}get context(){return Te.getLoggerContext(this.logger)}getPayloadType(t){const r=Vn(t);return gr(r.type)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Zn)}catch{t=Gn(),await this.keychain.set(Zn,t)}return nt(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Bo extends Vu{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=vo,this.version=Eo,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=zr(i);let c=this.messages.get(n);return typeof c>"u"&&(c={}),typeof c[s]<"u"||(c[s]=i,this.messages.set(n,c),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),c=zr(i);return typeof s[c]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Te.generateChildLogger(t,this.name),this.core=r}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,io(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?so(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}const zd="PARSE_ERROR",Hd="INVALID_REQUEST",Kd="METHOD_NOT_FOUND",Gd="INVALID_PARAMS",zo="INTERNAL_ERROR",ti="SERVER_ERROR",Vd=[-32700,-32600,-32601,-32602,-32603],vr={[zd]:{code:-32700,message:"Parse error"},[Hd]:{code:-32600,message:"Invalid Request"},[Kd]:{code:-32601,message:"Method not found"},[Gd]:{code:-32602,message:"Invalid params"},[zo]:{code:-32603,message:"Internal error"},[ti]:{code:-32e3,message:"Server error"}},Ho=ti;function qd(e){return Vd.includes(e)}function Ko(e){return Object.keys(vr).includes(e)?vr[e]:vr[Ho]}function Yd(e){const t=Object.values(vr).find(r=>r.code===e);return t||vr[Ho]}function Wd(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var Go={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ri=function(e,t){return ri=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ri(e,t)};function Xd(e,t){ri(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ni=function(){return ni=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ni.apply(this,arguments)};function kd(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Jd(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(s=(i<3?c(s):i>3?c(t,r,s):c(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Zd(e,t){return function(r,n){t(r,n,e)}}function Qd(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function e0(e,t,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(d){try{f(n.next(d))}catch(w){c(w)}}function h(d){try{f(n.throw(d))}catch(w){c(w)}}function f(d){d.done?s(d.value):i(d.value).then(u,h)}f((n=n.apply(e,t||[])).next())})}function t0(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(d){return h([f,d])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(d){f=[6,d],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function r0(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function n0(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function ii(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vo(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],c;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function i0(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Vo(arguments[t]));return e}function s0(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function Er(e){return this instanceof Er?(this.v=e,this):new Er(e)}function o0(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof Er?Promise.resolve(v.value.v).then(f,d):w(s[0][2],v)}function f(v){u("next",v)}function d(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function a0(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(c){return(r=!r)?{value:Er(e[i](c)),done:i==="return"}:s?s(c):c}:s}}function c0(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof ii=="function"?ii(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(c){return new Promise(function(u,h){c=e[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function u0(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function f0(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function h0(e){return e&&e.__esModule?e:{default:e}}function l0(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function d0(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var _0=Object.freeze({__proto__:null,__extends:Xd,get __assign(){return ni},__rest:kd,__decorate:Jd,__param:Zd,__metadata:Qd,__awaiter:e0,__generator:t0,__createBinding:r0,__exportStar:n0,__values:ii,__read:Vo,__spread:i0,__spreadArrays:s0,__await:Er,__asyncGenerator:o0,__asyncDelegator:a0,__asyncValues:c0,__makeTemplateObject:u0,__importStar:f0,__importDefault:h0,__classPrivateFieldGet:l0,__classPrivateFieldSet:d0}),g0=At(_0),wt={},qo;function y0(){if(qo)return wt;qo=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.isBrowserCryptoAvailable=wt.getSubtleCrypto=wt.getBrowerCrypto=void 0;function e(){return ke?.crypto||ke?.msCrypto||{}}wt.getBrowerCrypto=e;function t(){const n=e();return n.subtle||n.webkitSubtle}wt.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return wt.isBrowserCryptoAvailable=r,wt}var mt={},Yo;function p0(){if(Yo)return mt;Yo=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.isBrowser=mt.isNode=mt.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}mt.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}mt.isNode=t;function r(){return!e()&&!t()}return mt.isBrowser=r,mt}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=g0;t.__exportStar(y0(),e),t.__exportStar(p0(),e)})(Go);function b0(){const e=Date.now()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t}function si(e,t,r){return{id:r||b0(),jsonrpc:"2.0",method:e,params:t}}function Wo(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Xo(e,t,r){return{id:e,jsonrpc:"2.0",error:v0(t,r)}}function v0(e,t){return typeof e>"u"?Ko(zo):(typeof e=="string"&&(e=Object.assign(Object.assign({},Ko(ti)),{message:e})),typeof t<"u"&&(e.data=t),qd(e.code)&&(e=Yd(e.code)),e)}class E0{}class w0 extends E0{constructor(){super()}}class m0 extends w0{constructor(t){super()}}const D0="^wss?:";function S0(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function O0(e,t){const r=S0(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function ko(e){return O0(e,D0)}function x0(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function Jo(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Zo(e){return Jo(e)&&"method"in e}function Qo(e){return Jo(e)&&(ea(e)||Vr(e))}function ea(e){return"result"in e}function Vr(e){return"error"in e}class T0 extends m0{constructor(t){super(t),this.events=new ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(si(t.method,t.params||[]),r)}async requestStrict(t,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{Vr(s)?i(s.error):n(s.result)});try{await this.connection.send(t,r)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Qo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",t=>this.events.emit("error",t)),this.hasRegisteredEventListeners=!0)}}const ta=10,I0=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),R0=()=>typeof window<"u",A0=I0();class C0{constructor(t){if(this.url=t,this.events=new ut.exports.EventEmitter,this.registering=!1,!ko(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Dn(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!ko(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const i=Go.isReactNative()?void 0:{rejectUnauthorized:!x0(t)},s=new A0(t,[],i);R0()?s.onerror=c=>{const u=c;n(this.emitError(u.error))}:s.on("error",c=>{n(this.emitError(c))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=()=>this.onClose(),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Qi(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),i=n.message||n.toString(),s=Xo(t,i);this.events.emit("payload",s)}parseError(t,r=this.url){return Wd(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ta&&this.events.setMaxListeners(ta)}emitError(t){const r=this.parseError(new Error(t?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}class P0 extends qu{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new ut.exports.EventEmitter,this.name=mo,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const c=s?.ttl||wo,u=Xn(s),h=s?.prompt||!1,f=s?.tag||0,d={topic:n,message:i,opts:{ttl:c,relay:u,prompt:h,tag:f}},w=zr(i);this.queue.set(w,d);try{await await qn(this.rpcPublish(n,i,c,u,h,f),this.publishTimeout),this.relayer.events.emit(Ze.publish,d)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ze.connection_stalled);return}this.onPublish(w,d),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=t,this.logger=Te.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Te.getLoggerContext(this.logger)}rpcPublish(t,r,n,i,s,c){var u,h,f,d;const w={method:Hr(i.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:s,tag:c}};return Kr((u=w.params)==null?void 0:u.prompt)&&((h=w.params)==null||delete h.prompt),Kr((f=w.params)==null?void 0:f.tag)&&((d=w.params)==null||delete d.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.provider.request(w)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:i}=t;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(ir.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class L0{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(t);return}this.map.set(t,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var N0=Object.defineProperty,U0=Object.defineProperties,M0=Object.getOwnPropertyDescriptors,ra=Object.getOwnPropertySymbols,j0=Object.prototype.hasOwnProperty,$0=Object.prototype.propertyIsEnumerable,na=(e,t,r)=>t in e?N0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wr=(e,t)=>{for(var r in t||(t={}))j0.call(t,r)&&na(e,r,t[r]);if(ra)for(var r of ra(t))$0.call(t,r)&&na(e,r,t[r]);return e},oi=(e,t)=>U0(e,M0(t));class ia extends Xu{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new L0,this.events=new ut.exports.EventEmitter,this.name=Ro,this.version=Ao,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Et,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Xn(i),c={topic:n,relay:s};this.pending.set(n,c);const u=await this.rpcSubscribe(n,s);return this.onSubscribe(u,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const c=new De.Watch;c.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),i(!0)),c.elapsed(this.pendingSubscriptionWatchLabel)>=Co&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Te.generateChildLogger(r,this.name),this.clientId=""}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async i=>await this.unsubscribeById(t,i,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const i=Xn(n);await this.rpcUnsubscribe(t,r,i);const s=pr("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,r){const n={method:Hr(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await qn(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ze.connection_stalled)}return zr(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:Hr(r.protocol).batchSubscribe,params:{topics:t.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await qn(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ze.connection_stalled)}}rpcUnsubscribe(t,r,n){const i={method:Hr(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(t,r){this.setSubscription(t,oi(wr({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,wr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,wr({},r)),this.topicMap.set(r.topic,t),this.events.emit(dt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(dt.deleted,oi(wr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(dt.sync)}async reset(){if(!this.cached.length)return;const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}this.events.emit(dt.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);this.onBatchSubscribe(r.map((n,i)=>oi(wr({},t[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ir.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ze.connect,async()=>{await this.onConnect()}),this.relayer.on(Ze.disconnect,()=>{this.onDisconnect()}),this.events.on(dt.created,async t=>{const r=dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(dt.deleted,async t=>{const r=dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var F0=Object.defineProperty,sa=Object.getOwnPropertySymbols,B0=Object.prototype.hasOwnProperty,z0=Object.prototype.propertyIsEnumerable,oa=(e,t,r)=>t in e?F0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H0=(e,t)=>{for(var r in t||(t={}))B0.call(t,r)&&oa(e,r,t[r]);if(sa)for(var r of sa(t))z0.call(t,r)&&oa(e,r,t[r]);return e};class aa extends Yu{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new ut.exports.EventEmitter,this.name=Oo,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Te.generateChildLogger(t.logger,this.name):en(Te.getDefaultLoggerOptions({level:t.logger||So})),this.messages=new Bo(this.logger,t.core),this.subscriber=new ia(this,this.logger),this.publisher=new P0(this,this.logger),this.relayUrl=t?.relayUrl||Qn,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Te.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(dt.created,s=>{s.topic===t&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(t,r),i()})]),n}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ze.transport_closed))}async transportOpen(t){if(!this.reconnecting){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(dt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(Ze.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(Ze.transport_closed,this.rejectTransportOpen))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw r;this.logger.error(r),this.events.emit(Ze.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,ei)),await this.transportOpen(t))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new T0(new C0(bd({sdkVersion:To,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Zo(t)){if(!t.method.endsWith(xo))return;const r=t.params,{topic:n,message:i,publishedAt:s}=r.data,c={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(H0({type:"event",event:r.id},c)),this.events.emit(r.id,c),await this.acknowledgePayload(t),await this.onMessageEvent(c)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Ze.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Wo(t.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(br.payload,t=>this.onProviderPayload(t)),this.provider.on(br.connect,()=>{this.events.emit(Ze.connect)}),this.provider.on(br.disconnect,()=>{this.events.emit(Ze.disconnect),this.attemptToReconnect()}),this.provider.on(br.error,t=>this.events.emit(Ze.error,t)),this.events.on(Ze.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},De.toMiliseconds(ei))}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var ai={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,s=2,c=9007199254740991,u="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",d="[object Boolean]",w="[object Date]",v="[object Error]",b="[object Function]",T="[object GeneratorFunction]",U="[object Map]",L="[object Number]",K="[object Null]",S="[object Object]",I="[object Promise]",y="[object Proxy]",E="[object RegExp]",p="[object Set]",o="[object String]",_="[object Symbol]",j="[object Undefined]",F="[object WeakMap]",W="[object ArrayBuffer]",k="[object DataView]",J="[object Float32Array]",A="[object Float64Array]",R="[object Int8Array]",q="[object Int16Array]",$="[object Int32Array]",P="[object Uint8Array]",N="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[A]=Y[R]=Y[q]=Y[$]=Y[P]=Y[N]=Y[M]=Y[B]=!0,Y[u]=Y[h]=Y[W]=Y[d]=Y[k]=Y[w]=Y[v]=Y[b]=Y[U]=Y[L]=Y[S]=Y[E]=Y[p]=Y[o]=Y[F]=!1;var oe=typeof ke=="object"&&ke&&ke.Object===Object&&ke,x=typeof self=="object"&&self&&self.Object===Object&&self,O=oe||x||Function("return this")(),m=t&&!t.nodeType&&t,a=m&&!0&&e&&!e.nodeType&&e,g=a&&a.exports===m,H=g&&oe.process,G=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),fe=G&&G.isTypedArray;function ye(l,D){for(var C=-1,V=l==null?0:l.length,Ie=0,ne=[];++C<V;){var Ne=l[C];D(Ne,C,l)&&(ne[Ie++]=Ne)}return ne}function le(l,D){for(var C=-1,V=D.length,Ie=l.length;++C<V;)l[Ie+C]=D[C];return l}function ve(l,D){for(var C=-1,V=l==null?0:l.length;++C<V;)if(D(l[C],C,l))return!0;return!1}function Ue(l,D){for(var C=-1,V=Array(l);++C<l;)V[C]=D(C);return V}function Ce(l){return function(D){return l(D)}}function ge(l,D){return l.has(D)}function de(l,D){return l?.[D]}function he(l){var D=-1,C=Array(l.size);return l.forEach(function(V,Ie){C[++D]=[Ie,V]}),C}function ce(l,D){return function(C){return l(D(C))}}function ae(l){var D=-1,C=Array(l.size);return l.forEach(function(V){C[++D]=V}),C}var se=Array.prototype,ie=Function.prototype,Q=Object.prototype,ue=O["__core-js_shared__"],_e=ie.toString,te=Q.hasOwnProperty,pe=function(){var l=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),be=Q.toString,we=RegExp("^"+_e.call(te).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),me=g?O.Buffer:void 0,Ee=O.Symbol,gt=O.Uint8Array,vt=Q.propertyIsEnumerable,xt=se.splice,at=Ee?Ee.toStringTag:void 0,jt=Object.getOwnPropertySymbols,mr=me?me.isBuffer:void 0,Yr=ce(Object.keys,Object),Me=kt(O,"DataView"),Pe=kt(O,"Map"),je=kt(O,"Promise"),$e=kt(O,"Set"),Fe=kt(O,"WeakMap"),Le=kt(Object,"create"),He=Ft(Me),Ke=Ft(Pe),Ge=Ft(je),Ve=Ft($e),qe=Ft(Fe),ze=Ee?Ee.prototype:void 0,Be=ze?ze.valueOf:void 0;function Re(l){var D=-1,C=l==null?0:l.length;for(this.clear();++D<C;){var V=l[D];this.set(V[0],V[1])}}function Ye(){this.__data__=Le?Le(null):{},this.size=0}function We(l){var D=this.has(l)&&delete this.__data__[l];return this.size-=D?1:0,D}function J0(l){var D=this.__data__;if(Le){var C=D[l];return C===n?void 0:C}return te.call(D,l)?D[l]:void 0}function Z0(l){var D=this.__data__;return Le?D[l]!==void 0:te.call(D,l)}function Q0(l,D){var C=this.__data__;return this.size+=this.has(l)?0:1,C[l]=Le&&D===void 0?n:D,this}Re.prototype.clear=Ye,Re.prototype.delete=We,Re.prototype.get=J0,Re.prototype.has=Z0,Re.prototype.set=Q0;function Dt(l){var D=-1,C=l==null?0:l.length;for(this.clear();++D<C;){var V=l[D];this.set(V[0],V[1])}}function e_(){this.__data__=[],this.size=0}function t_(l){var D=this.__data__,C=Xr(D,l);if(C<0)return!1;var V=D.length-1;return C==V?D.pop():xt.call(D,C,1),--this.size,!0}function r_(l){var D=this.__data__,C=Xr(D,l);return C<0?void 0:D[C][1]}function n_(l){return Xr(this.__data__,l)>-1}function i_(l,D){var C=this.__data__,V=Xr(C,l);return V<0?(++this.size,C.push([l,D])):C[V][1]=D,this}Dt.prototype.clear=e_,Dt.prototype.delete=t_,Dt.prototype.get=r_,Dt.prototype.has=n_,Dt.prototype.set=i_;function $t(l){var D=-1,C=l==null?0:l.length;for(this.clear();++D<C;){var V=l[D];this.set(V[0],V[1])}}function s_(){this.size=0,this.__data__={hash:new Re,map:new(Pe||Dt),string:new Re}}function o_(l){var D=kr(this,l).delete(l);return this.size-=D?1:0,D}function a_(l){return kr(this,l).get(l)}function c_(l){return kr(this,l).has(l)}function u_(l,D){var C=kr(this,l),V=C.size;return C.set(l,D),this.size+=C.size==V?0:1,this}$t.prototype.clear=s_,$t.prototype.delete=o_,$t.prototype.get=a_,$t.prototype.has=c_,$t.prototype.set=u_;function Wr(l){var D=-1,C=l==null?0:l.length;for(this.__data__=new $t;++D<C;)this.add(l[D])}function f_(l){return this.__data__.set(l,n),this}function h_(l){return this.__data__.has(l)}Wr.prototype.add=Wr.prototype.push=f_,Wr.prototype.has=h_;function Tt(l){var D=this.__data__=new Dt(l);this.size=D.size}function l_(){this.__data__=new Dt,this.size=0}function d_(l){var D=this.__data__,C=D.delete(l);return this.size=D.size,C}function __(l){return this.__data__.get(l)}function g_(l){return this.__data__.has(l)}function y_(l,D){var C=this.__data__;if(C instanceof Dt){var V=C.__data__;if(!Pe||V.length<r-1)return V.push([l,D]),this.size=++C.size,this;C=this.__data__=new $t(V)}return C.set(l,D),this.size=C.size,this}Tt.prototype.clear=l_,Tt.prototype.delete=d_,Tt.prototype.get=__,Tt.prototype.has=g_,Tt.prototype.set=y_;function p_(l,D){var C=Jr(l),V=!C&&P_(l),Ie=!C&&!V&&ci(l),ne=!C&&!V&&!Ie&&xa(l),Ne=C||V||Ie||ne,Xe=Ne?Ue(l.length,String):[],Qe=Xe.length;for(var Ae in l)(D||te.call(l,Ae))&&!(Ne&&(Ae=="length"||Ie&&(Ae=="offset"||Ae=="parent")||ne&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||T_(Ae,Qe)))&&Xe.push(Ae);return Xe}function Xr(l,D){for(var C=l.length;C--;)if(ma(l[C][0],D))return C;return-1}function b_(l,D,C){var V=D(l);return Jr(l)?V:le(V,C(l))}function Dr(l){return l==null?l===void 0?j:K:at&&at in Object(l)?O_(l):C_(l)}function ba(l){return Sr(l)&&Dr(l)==u}function va(l,D,C,V,Ie){return l===D?!0:l==null||D==null||!Sr(l)&&!Sr(D)?l!==l&&D!==D:v_(l,D,C,V,va,Ie)}function v_(l,D,C,V,Ie,ne){var Ne=Jr(l),Xe=Jr(D),Qe=Ne?h:It(l),Ae=Xe?h:It(D);Qe=Qe==u?S:Qe,Ae=Ae==u?S:Ae;var ct=Qe==S,yt=Ae==S,tt=Qe==Ae;if(tt&&ci(l)){if(!ci(D))return!1;Ne=!0,ct=!1}if(tt&&!ct)return ne||(ne=new Tt),Ne||xa(l)?Ea(l,D,C,V,Ie,ne):D_(l,D,Qe,C,V,Ie,ne);if(!(C&i)){var ht=ct&&te.call(l,"__wrapped__"),lt=yt&&te.call(D,"__wrapped__");if(ht||lt){var Rt=ht?l.value():l,St=lt?D.value():D;return ne||(ne=new Tt),Ie(Rt,St,C,V,ne)}}return tt?(ne||(ne=new Tt),S_(l,D,C,V,Ie,ne)):!1}function E_(l){if(!Oa(l)||R_(l))return!1;var D=Da(l)?we:z;return D.test(Ft(l))}function w_(l){return Sr(l)&&Sa(l.length)&&!!Y[Dr(l)]}function m_(l){if(!A_(l))return Yr(l);var D=[];for(var C in Object(l))te.call(l,C)&&C!="constructor"&&D.push(C);return D}function Ea(l,D,C,V,Ie,ne){var Ne=C&i,Xe=l.length,Qe=D.length;if(Xe!=Qe&&!(Ne&&Qe>Xe))return!1;var Ae=ne.get(l);if(Ae&&ne.get(D))return Ae==D;var ct=-1,yt=!0,tt=C&s?new Wr:void 0;for(ne.set(l,D),ne.set(D,l);++ct<Xe;){var ht=l[ct],lt=D[ct];if(V)var Rt=Ne?V(lt,ht,ct,D,l,ne):V(ht,lt,ct,l,D,ne);if(Rt!==void 0){if(Rt)continue;yt=!1;break}if(tt){if(!ve(D,function(St,Bt){if(!ge(tt,Bt)&&(ht===St||Ie(ht,St,C,V,ne)))return tt.push(Bt)})){yt=!1;break}}else if(!(ht===lt||Ie(ht,lt,C,V,ne))){yt=!1;break}}return ne.delete(l),ne.delete(D),yt}function D_(l,D,C,V,Ie,ne,Ne){switch(C){case k:if(l.byteLength!=D.byteLength||l.byteOffset!=D.byteOffset)return!1;l=l.buffer,D=D.buffer;case W:return!(l.byteLength!=D.byteLength||!ne(new gt(l),new gt(D)));case d:case w:case L:return ma(+l,+D);case v:return l.name==D.name&&l.message==D.message;case E:case o:return l==D+"";case U:var Xe=he;case p:var Qe=V&i;if(Xe||(Xe=ae),l.size!=D.size&&!Qe)return!1;var Ae=Ne.get(l);if(Ae)return Ae==D;V|=s,Ne.set(l,D);var ct=Ea(Xe(l),Xe(D),V,Ie,ne,Ne);return Ne.delete(l),ct;case _:if(Be)return Be.call(l)==Be.call(D)}return!1}function S_(l,D,C,V,Ie,ne){var Ne=C&i,Xe=wa(l),Qe=Xe.length,Ae=wa(D),ct=Ae.length;if(Qe!=ct&&!Ne)return!1;for(var yt=Qe;yt--;){var tt=Xe[yt];if(!(Ne?tt in D:te.call(D,tt)))return!1}var ht=ne.get(l);if(ht&&ne.get(D))return ht==D;var lt=!0;ne.set(l,D),ne.set(D,l);for(var Rt=Ne;++yt<Qe;){tt=Xe[yt];var St=l[tt],Bt=D[tt];if(V)var Ta=Ne?V(Bt,St,tt,D,l,ne):V(St,Bt,tt,l,D,ne);if(!(Ta===void 0?St===Bt||Ie(St,Bt,C,V,ne):Ta)){lt=!1;break}Rt||(Rt=tt=="constructor")}if(lt&&!Rt){var Zr=l.constructor,Qr=D.constructor;Zr!=Qr&&"constructor"in l&&"constructor"in D&&!(typeof Zr=="function"&&Zr instanceof Zr&&typeof Qr=="function"&&Qr instanceof Qr)&&(lt=!1)}return ne.delete(l),ne.delete(D),lt}function wa(l){return b_(l,U_,x_)}function kr(l,D){var C=l.__data__;return I_(D)?C[typeof D=="string"?"string":"hash"]:C.map}function kt(l,D){var C=de(l,D);return E_(C)?C:void 0}function O_(l){var D=te.call(l,at),C=l[at];try{l[at]=void 0;var V=!0}catch{}var Ie=be.call(l);return V&&(D?l[at]=C:delete l[at]),Ie}var x_=jt?function(l){return l==null?[]:(l=Object(l),ye(jt(l),function(D){return vt.call(l,D)}))}:M_,It=Dr;(Me&&It(new Me(new ArrayBuffer(1)))!=k||Pe&&It(new Pe)!=U||je&&It(je.resolve())!=I||$e&&It(new $e)!=p||Fe&&It(new Fe)!=F)&&(It=function(l){var D=Dr(l),C=D==S?l.constructor:void 0,V=C?Ft(C):"";if(V)switch(V){case He:return k;case Ke:return U;case Ge:return I;case Ve:return p;case qe:return F}return D});function T_(l,D){return D=D??c,!!D&&(typeof l=="number"||Z.test(l))&&l>-1&&l%1==0&&l<D}function I_(l){var D=typeof l;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?l!=="__proto__":l===null}function R_(l){return!!pe&&pe in l}function A_(l){var D=l&&l.constructor,C=typeof D=="function"&&D.prototype||Q;return l===C}function C_(l){return be.call(l)}function Ft(l){if(l!=null){try{return _e.call(l)}catch{}try{return l+""}catch{}}return""}function ma(l,D){return l===D||l!==l&&D!==D}var P_=ba(function(){return arguments}())?ba:function(l){return Sr(l)&&te.call(l,"callee")&&!vt.call(l,"callee")},Jr=Array.isArray;function L_(l){return l!=null&&Sa(l.length)&&!Da(l)}var ci=mr||j_;function N_(l,D){return va(l,D)}function Da(l){if(!Oa(l))return!1;var D=Dr(l);return D==b||D==T||D==f||D==y}function Sa(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=c}function Oa(l){var D=typeof l;return l!=null&&(D=="object"||D=="function")}function Sr(l){return l!=null&&typeof l=="object"}var xa=fe?Ce(fe):w_;function U_(l){return L_(l)?p_(l):m_(l)}function M_(){return[]}function j_(){return!1}e.exports=N_})(ai,ai.exports);var K0=ai.exports,G0=Object.defineProperty,ca=Object.getOwnPropertySymbols,V0=Object.prototype.hasOwnProperty,q0=Object.prototype.propertyIsEnumerable,ua=(e,t,r)=>t in e?G0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fa=(e,t)=>{for(var r in t||(t={}))V0.call(t,r)&&ua(e,r,t[r]);if(ca)for(var r of ca(t))q0.call(t,r)&&ua(e,r,t[r]);return e};class ha extends Wu{constructor(t,r,n,i=Et,s=void 0){super(t,r,n,i),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=Io,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(c=>{Ud(c)?this.map.set(c.id,c):Md(c)?this.map.set(c.topic,c):this.getKey&&c!==null&&!Kr(c)&&this.map.set(this.getKey(c),c)}),this.cached=[],this.initialized=!0)},this.set=async(c,u)=>{this.isInitialized(),this.map.has(c)?await this.update(c,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:c,value:u}),this.map.set(c,u),await this.persist())},this.get=c=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:c}),this.getData(c)),this.getAll=c=>(this.isInitialized(),c?this.values.filter(u=>Object.keys(c).every(h=>K0(u[h],c[h]))):this.values),this.update=async(c,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:c,update:u});const h=fa(fa({},this.getData(c)),u);this.map.set(c,h),await this.persist()},this.delete=async(c,u)=>{this.isInitialized(),this.map.has(c)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:c,reason:u}),this.map.delete(c),await this.persist())},this.logger=Te.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}class la{constructor(t,r){this.core=t,this.logger=r,this.name=Po,this.version=Lo,this.events=new ut.exports,this.initialized=!1,this.storagePrefix=Et,this.ignoredPayloadTypes=[Wt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Gn(),i=await this.core.crypto.setSymKey(n),s=Yn(De.FIVE_MINUTES),c={protocol:Do},u={topic:i,expiry:s,relay:c,active:!1},h=Cd({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:c});return await this.pairings.set(i,u),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:c}=Rd(n.uri),u=Yn(De.FIVE_MINUTES),h={topic:i,relay:c,expiry:u,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:c}),this.core.expirer.set(i,u),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=Yn(De.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:c,resolve:u,reject:h}=vd();this.events.once(Wn("pairing_ping",s),({error:f})=>{f?h(f):u()}),await c()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",pr("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const c=si(i,s),u=await this.core.crypto.encode(n,c),h=Xt[i].req;return this.core.history.set(n,c),await this.core.relayer.publish(n,u,h),c.id},this.sendResult=async(n,i,s)=>{const c=Wo(n,s),u=await this.core.crypto.encode(i,c),h=await this.core.history.get(i,n),f=Xt[h.request.method].res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.sendError=async(n,i,s)=>{const c=Xo(n,s),u=await this.core.crypto.encode(i,c),h=await this.core.history.get(i,n),f=Xt[h.request.method]?Xt[h.request.method].res:Xt.unregistered_method.res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,pr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>ao(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,c=s.method;if(this.pairings.keys.includes(i))switch(c){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,c=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(c){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(c)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{ea(i)?this.events.emit(Wn("pairing_ping",s),{}):Vr(i)&&this.events.emit(Wn("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:c}=i;try{if(this.registeredMethods.includes(c))return;const u=pr("WC_METHOD_UNSUPPORTED",c);await this.sendError(s,n,u),this.logger.error(u)}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(pr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!kn(n)){const{message:i}=xe("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!Nd(n.uri)){const{message:i}=xe("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!kn(n)){const{message:s}=xe("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!kn(n)){const{message:s}=xe("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!fo(n,!1)){const{message:i}=xe("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=xe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(ao(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=xe("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=t,this.logger=Te.generateChildLogger(r,this.name),this.pairings=new ha(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Te.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Ze.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Zo(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Qo(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(ft.expired,async t=>{const{topic:r}=md(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class da extends Gu{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new ut.exports.EventEmitter,this.name=No,this.version=Uo,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const c={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(c.id,c),this.events.emit(_t.created,c)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Vr(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(_t.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(_t.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:si(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(_t.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(_t.created,t=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(_t.updated,t=>{const r=_t.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(_t.deleted,t=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}class _a extends ku{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new ut.exports.EventEmitter,this.name=Mo,this.version=jo,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),c={target:s,expiry:i};this.expirations.set(s,c),this.checkExpiry(s,c),this.events.emit(ft.created,{target:s,expiration:c})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(ft.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Ed(t);if(typeof t=="number")return wd(t);const{message:r}=xe("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ft.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;De.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(ft.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ir.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ft.created,t=>{const r=ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(ft.expired,t=>{const r=ft.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(ft.deleted,t=>{const r=ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=xe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Y0=Object.defineProperty,ga=Object.getOwnPropertySymbols,W0=Object.prototype.hasOwnProperty,X0=Object.prototype.propertyIsEnumerable,ya=(e,t,r)=>t in e?Y0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pa=(e,t)=>{for(var r in t||(t={}))W0.call(t,r)&&ya(e,r,t[r]);if(ga)for(var r of ga(t))X0.call(t,r)&&ya(e,r,t[r]);return e};class qr extends Ku{constructor(t){super(t),this.protocol=Jn,this.version=ho,this.name=Gr,this.events=new ut.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||Qn;const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:en(Te.getDefaultLoggerOptions({level:t?.logger||lo.logger}));this.logger=Te.generateChildLogger(r,this.name),this.heartbeat=new ir.HeartBeat,this.crypto=new Fo(this,this.logger,t?.keychain),this.history=new da(this,this.logger),this.expirer=new _a(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new wc(pa(pa({},_o),t?.storageOptions)),this.relayer=new aa({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new la(this,this.logger)}static async init(t){const r=new qr(t);return await r.initialize(),r}get context(){return Te.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const k0=qr;X.CORE_CONTEXT=Gr,X.CORE_DEFAULT=lo,X.CORE_PROTOCOL=Jn,X.CORE_STORAGE_OPTIONS=_o,X.CORE_STORAGE_PREFIX=Et,X.CORE_VERSION=ho,X.CRYPTO_CLIENT_SEED=Zn,X.CRYPTO_CONTEXT=go,X.CRYPTO_JWT_TTL=yo,X.Core=k0,X.Crypto=Fo,X.EXPIRER_CONTEXT=Mo,X.EXPIRER_DEFAULT_TTL=Bd,X.EXPIRER_EVENTS=ft,X.EXPIRER_STORAGE_VERSION=jo,X.Expirer=_a,X.HISTORY_CONTEXT=No,X.HISTORY_EVENTS=_t,X.HISTORY_STORAGE_VERSION=Uo,X.JsonRpcHistory=da,X.KEYCHAIN_CONTEXT=po,X.KEYCHAIN_STORAGE_VERSION=bo,X.KeyChain=$o,X.MESSAGES_CONTEXT=vo,X.MESSAGES_STORAGE_VERSION=Eo,X.MessageTracker=Bo,X.PAIRING_CONTEXT=Po,X.PAIRING_DEFAULT_TTL=Fd,X.PAIRING_RPC_OPTS=Xt,X.PAIRING_STORAGE_VERSION=Lo,X.PENDING_SUB_RESOLUTION_TIMEOUT=Co,X.PUBLISHER_CONTEXT=mo,X.PUBLISHER_DEFAULT_TTL=wo,X.Pairing=la,X.RELAYER_CONTEXT=Oo,X.RELAYER_DEFAULT_LOGGER=So,X.RELAYER_DEFAULT_PROTOCOL=Do,X.RELAYER_DEFAULT_RELAY_URL=Qn,X.RELAYER_EVENTS=Ze,X.RELAYER_PROVIDER_EVENTS=br,X.RELAYER_RECONNECT_TIMEOUT=ei,X.RELAYER_SDK_VERSION=To,X.RELAYER_STORAGE_OPTIONS=jd,X.RELAYER_SUBSCRIBER_SUFFIX=xo,X.Relayer=aa,X.STORE_STORAGE_VERSION=Io,X.SUBSCRIBER_CONTEXT=Ro,X.SUBSCRIBER_DEFAULT_TTL=$d,X.SUBSCRIBER_EVENTS=dt,X.SUBSCRIBER_STORAGE_VERSION=Ao,X.Store=ha,X.Subscriber=ia,X.default=qr,Object.defineProperty(X,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
